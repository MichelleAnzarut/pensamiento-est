<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Pensamiento estadístico - 15&nbsp; Modelos probabilísticos para variables continuas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-inferencia-modelos.html" rel="next">
<link href="./06-maxima-verosimilitud-1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sín resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modelos probabilísticos para variables continuas</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pensamiento estadístico</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Acerca del curso</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-intro-est-cd-1.html" class="sidebar-item-text sidebar-link">Estadística y ciencia de datos</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-est-cd-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preguntas y datos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-diagramas-est-cd-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Diagramas causales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-proceso-est-cd-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Procesos generadores de datos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-resumenes.html" class="sidebar-item-text sidebar-link">Resúmenes y descripciones de datos</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-resumenes-analisis-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resúmenes para datos numéricos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-resumenes-analisis-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Datos univariados categóricos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03-intro-inferencia.html" class="sidebar-item-text sidebar-link">Inferencia estadística: pruebas de hipótesis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-intro-pruebas-hipotesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introducción a pruebas de hipótesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-pruebas-hipotesis-aleatorizacion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Aleatorización en inferencia causal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-pruebas-hipotesis-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Diseño de experimentos e inferencia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-pruebas-hipotesis-3.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Más acerca de pruebas de hipótesis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./04-estimacion.html" class="sidebar-item-text sidebar-link">Inferencia estadística: estimación</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-estimacion-aleatorizacion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Inferencia por intervalos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-estimacion-remuestreo.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Remuestreo: el bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./05-probabilidad.html" class="sidebar-item-text sidebar-link">Introducción a modelos probabilísticos</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-prob-modelos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Básicos de probabilidad y simulación</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-prob-condicional.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probabilidad condicional e independencia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-maxima-verosimilitud-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Estimación por máxima verosimilitud</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-prob-modelos-continuos.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modelos probabilísticos para variables continuas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06-inferencia-modelos.html" class="sidebar-item-text sidebar-link">Inferencia con modelos bayesianos</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-intro-bayesiana-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Introducción a inferencia bayesiana</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-intro-bayesiana-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Calibración bayesiana y Regularización</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Indice de contenidos</h2>
   
  <ul>
  <li><a href="#ejemplo-ruleta-justa" id="toc-ejemplo-ruleta-justa" class="nav-link active" data-scroll-target="#ejemplo-ruleta-justa"> <span class="header-section-number">15.0.1</span> Ejemplo: ruleta justa</a></li>
  <li><a href="#modelo-equiprobable-o-uniforme" id="toc-modelo-equiprobable-o-uniforme" class="nav-link" data-scroll-target="#modelo-equiprobable-o-uniforme"> <span class="header-section-number">15.1</span> Modelo equiprobable o uniforme</a>
  <ul class="collapse">
  <li><a href="#ejemplo-ruleta-sesgada" id="toc-ejemplo-ruleta-sesgada" class="nav-link" data-scroll-target="#ejemplo-ruleta-sesgada"> <span class="header-section-number">15.1.1</span> Ejemplo: ruleta sesgada</a></li>
  </ul></li>
  <li><a href="#funciones-de-densidad" id="toc-funciones-de-densidad" class="nav-link" data-scroll-target="#funciones-de-densidad"> <span class="header-section-number">15.2</span> Funciones de densidad</a></li>
  <li><a href="#ejemplo-densidad-triangular" id="toc-ejemplo-densidad-triangular" class="nav-link" data-scroll-target="#ejemplo-densidad-triangular"> <span class="header-section-number">15.3</span> Ejemplo: densidad triangular</a>
  <ul class="collapse">
  <li><a href="#ejemplo" id="toc-ejemplo" class="nav-link" data-scroll-target="#ejemplo">Ejemplo</a></li>
  </ul></li>
  <li><a href="#cuantiles-de-variables-aleatorias" id="toc-cuantiles-de-variables-aleatorias" class="nav-link" data-scroll-target="#cuantiles-de-variables-aleatorias"> <span class="header-section-number">15.4</span> Cuantiles de variables aleatorias</a>
  <ul class="collapse">
  <li><a href="#ejemplo-densidad-triangular-1" id="toc-ejemplo-densidad-triangular-1" class="nav-link" data-scroll-target="#ejemplo-densidad-triangular-1">Ejemplo: densidad triangular</a></li>
  <li><a href="#ejercicio-densidad-uniforme" id="toc-ejercicio-densidad-uniforme" class="nav-link" data-scroll-target="#ejercicio-densidad-uniforme">Ejercicio: densidad uniforme</a></li>
  </ul></li>
  <li><a href="#comparando-cuantiles-teóricos-y-empíricos" id="toc-comparando-cuantiles-teóricos-y-empíricos" class="nav-link" data-scroll-target="#comparando-cuantiles-teóricos-y-empíricos"> <span class="header-section-number">15.5</span> Comparando cuantiles teóricos y empíricos</a>
  <ul class="collapse">
  <li><a href="#ejemplo-distribución-uniforme" id="toc-ejemplo-distribución-uniforme" class="nav-link" data-scroll-target="#ejemplo-distribución-uniforme"> <span class="header-section-number">15.5.1</span> Ejemplo: distribución uniforme</a></li>
  <li><a href="#ejemplo-distribución-triangular" id="toc-ejemplo-distribución-triangular" class="nav-link" data-scroll-target="#ejemplo-distribución-triangular"> <span class="header-section-number">15.5.2</span> Ejemplo: distribución triangular</a></li>
  </ul></li>
  <li><a href="#la-distribución-normal" id="toc-la-distribución-normal" class="nav-link" data-scroll-target="#la-distribución-normal"> <span class="header-section-number">15.6</span> La distribución normal</a>
  <ul class="collapse">
  <li><a href="#promedio-de-variables" id="toc-promedio-de-variables" class="nav-link" data-scroll-target="#promedio-de-variables"> <span class="header-section-number">15.6.1</span> Promedio de variables</a></li>
  </ul></li>
  <li><a href="#la-densidad-normal-estándar" id="toc-la-densidad-normal-estándar" class="nav-link" data-scroll-target="#la-densidad-normal-estándar"> <span class="header-section-number">15.7</span> La densidad normal estándar</a></li>
  <li><a href="#cuantiles-y-concentración-de-la-densidad-normal" id="toc-cuantiles-y-concentración-de-la-densidad-normal" class="nav-link" data-scroll-target="#cuantiles-y-concentración-de-la-densidad-normal"> <span class="header-section-number">15.8</span> Cuantiles y concentración de la densidad normal</a></li>
  <li><a href="#el-teorema-central-del-límite" id="toc-el-teorema-central-del-límite" class="nav-link" data-scroll-target="#el-teorema-central-del-límite"> <span class="header-section-number">15.9</span> El teorema central del límite</a></li>
  <li><a href="#máxima-verosimilitud-modelos-continuos" id="toc-máxima-verosimilitud-modelos-continuos" class="nav-link" data-scroll-target="#máxima-verosimilitud-modelos-continuos"> <span class="header-section-number">15.10</span> Máxima verosimilitud: modelos continuos</a></li>
  <li><a href="#resumen" id="toc-resumen" class="nav-link" data-scroll-target="#resumen"> <span class="header-section-number">15.11</span> Resumen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Modelos probabilísticos para variables continuas</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>En la parte anterior consideramos un número fijo de resultados numéricos de experimentos aleatorios, por ejemplo, cuando <span class="math inline">\(X\)</span> el resultado de una tirada de dado. En este caso, un modelo de probabilidad para <span class="math inline">\(X\)</span> asigna una probabilidad dada a cada posible resultado, por ejemplo</p>
<p><span class="math display">\[P(X=1) = 1/6\]</span></p>
<p>e igualmente <span class="math inline">\(P(X=2)=\cdots = P(X=6) = 1/6\)</span>. En muchos casos, la cantidad <span class="math inline">\(X\)</span> que nos interesa puede tomar valores numéricos arbitrarios, y en este esquema no está claro cómo asignaríamos probabilidades.</p>
<section id="ejemplo-ruleta-justa" class="level3" data-number="15.0.1">
<h3 data-number="15.0.1" class="anchored" data-anchor-id="ejemplo-ruleta-justa"><span class="header-section-number">15.0.1</span> Ejemplo: ruleta justa</h3>
<p>Supongamos que giramos una ruleta con una flecha indicadora, y el resultado del experimento es el ángulo en grados final de la flecha. ¿Cómo podríamos poner, por ejemplo <span class="math inline">\(P(X= 92.7)\)</span>? ¿Qué pasa si podemos medir con resultados con varios decimales de exactitud?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imagenes/ruleta.jpeg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Ruleta</figcaption><p></p>
</figure>
</div>
<p>En estos casos, en lugar de considerar eventos de la forma <span class="math inline">\(X=a\)</span>, podemos considerar eventos resultantes de la forma <span class="math inline">\(a\leq X \leq b\)</span>, es decir, buscamos asignar probabilidades a eventos de la forma</p>
<p><span class="math display">\[P(X \in [a,b]).\]</span></p>
<p>Por ejemplo, si <span class="math inline">\(Y\)</span> es la estatura adulta de una persona que acaba de nacer, podríamos preguntarnos cómo asignar probabilidades a eventos como</p>
<p><span class="math display">\[P(Y\in [150,170]) = P(150\leq Y \leq 170),\]</span></p>
<p>y quizá también otros como</p>
<p><span class="math display">\[P(Y &lt; 180).\]</span></p>
</section>
<section id="modelo-equiprobable-o-uniforme" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="modelo-equiprobable-o-uniforme"><span class="header-section-number">15.1</span> Modelo equiprobable o uniforme</h2>
<p>Los modelos más simple para una medición continua <span class="math inline">\(X\)</span> son los modelos uniformes.</p>
<p>Para nuestra ruleta, por ejemplo, <span class="math inline">\(X\)</span> puede tomar valores en el intervalo <span class="math inline">\([0, 360)\)</span>. Si la ruleta es justa, entonces la probabilidad de que la flecha caiga en cualquier sector <span class="math inline">\([a,b]\)</span> debe ser igual. Una manera de lograr esto usar como probabilidad la proporción de la longitud de <span class="math inline">\([a,b]\)</span> con respecto al total de <span class="math inline">\([0, 360)\)</span>:</p>
<p><span class="math display">\[P(X\in [a,b]) = \frac{b-a}{360}.\]</span></p>
<ul>
<li>Discute por qué esta asignación de probabilidades satisface las tres reglas básicas de probabilidad (axiomas) que presentamos anteriormente.</li>
<li>Este es el equivalente continuos para espacios equiprobables con un número finito de resultados.</li>
</ul>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Supongamos que una variable aleatoria puede tomar valores en el intervalo <span class="math inline">\([L,U]\)</span>. La variable aleatoria es <strong>uniforme</strong> en <span class="math inline">\([L,U]\)</span> cuando</p>
<p><span class="math display">\[P(X \in [a,b]) = \frac{b-a}{L-U}\]</span></p>
</div>
</div>
<section id="ejemplo-ruleta-sesgada" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="ejemplo-ruleta-sesgada"><span class="header-section-number">15.1.1</span> Ejemplo: ruleta sesgada</h3>
<p>Ahora supongamos que nuestra ruleta no está del todo balanceada. Por ejemplo, podría ser estuviera colgada en una pared, y al girar la flecha es un poco más probable que la flecha apunte hacia el piso en lugar de hacia el cielo.</p>
<p>En este caso, si la dirección hacia arriba es 90 grados y hacia abajo es 270 grados, quisiéramos por ejemplo que</p>
<p><span class="math display">\[P(260 &lt; X &lt;280) &gt; P(80 &lt; X &lt; 100)\]</span></p>
<p>Y nótese que debe ser posible asignar probabilidades a cualquier sector de la ruleta con el nuevo modelo que propongamos. ¿Cómo podríamos modificar nuestra asignación de probabilidades?</p>
<p>Una de las maneras más fáciles es pensando que nuestra probabilidad se obtiene integrando una funcion constante:</p>
<ul>
<li>Si <span class="math inline">\([a,b]\)</span> es un sector de la ruleta con <span class="math inline">\(a&lt;b\)</span>, podríamos poner</li>
</ul>
<p><span class="math display">\[P(X\in [a,b]) = \int_a^b \frac{1}{360} \,dx = \frac{b-a}{360}\]</span></p>
<p>De forma que si <span class="math inline">\(f(x)= 1/360\)</span> para valores <span class="math inline">\(0 \leq x &lt; 360\)</span>, nuestra probabilidad se escribe como la integral</p>
<p><span class="math display">\[P(X\in [a,b]) = \int_a^b f(x) \,dx \]</span></p>
<ul>
<li>En este caso, probabilidad es área bajo la curva <span class="math inline">\(f(x)=1/360\)</span> que se calcula integrando sobre el intervalo de interés</li>
</ul>
<p>Para generalizar la idea es la siguiente:</p>
<ul>
<li>Usamos la fórmula anterior, pero modificamos o perturbamos la función <span class="math inline">\(f(x) = 1/360\)</span> para que <span class="math inline">\(f\)</span> sea un poco más alta alrededor de 270 grados (abajo), y un poco más baja alrededor de 90 grados (arriba).</li>
<li>Lo único que necesitamos es que <span class="math inline">\(f(x)\)</span> no puede tomar valores negativos (por que si no obtendríamos probabilidades negativas en algunos sectores), y la integral sobre la ruleta completa debe ser uno:</li>
</ul>
<p><span class="math display">\[P(X\in [0, 360]) = \int_0^{360} f(x)\,dx = 1\]</span></p>
<p>Podríamos utilizar por ejemplo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>f_dens <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    x_rad <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x <span class="sc">/</span> <span class="dv">360</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">/</span><span class="dv">360</span>) <span class="sc">+</span>  <span class="fl">0.0002</span> <span class="sc">*</span> <span class="fu">cos</span>(x_rad <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> pi  <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>graf_1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">angulo =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dv">1</span>), <span class="at">tipo =</span> <span class="st">"uniforme"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">f =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">360</span>) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>graf_2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">angulo =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dv">1</span>), <span class="at">tipo =</span> <span class="st">"colgada"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">f_dens</span>(angulo))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>graf_tbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(graf_1_tbl, graf_2_tbl)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(graf_tbl, <span class="fu">aes</span>(<span class="at">x =</span> angulo, <span class="at">y =</span> f, <span class="at">colour =</span> tipo)) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.003</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>tipo, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>El cálculo se hace ahora con área bajo la curva. Para calcular la probabilidad</p>
<p><span class="math display">\[P(X\in [50, 130]),\]</span></p>
<p>integramos la función <span class="math inline">\(f\)</span> correspondiente, que corresponde a calcular área bajo la curva:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(graf_tbl, <span class="fu">aes</span>(<span class="at">x =</span> angulo, <span class="at">y =</span> f, <span class="at">colour =</span> tipo)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.003</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>tipo, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(angulo <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> angulo <span class="sc">&lt;</span> <span class="dv">130</span>, angulo, <span class="dv">0</span>)), </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Y ahora vemos que para la versión perturbada, más de la probabilidad se concentra alrededor de 270 grados que alrededor de 90. Por las propiedades de la integral, todas las propiedades usuales de probabilidad se cumplen.</p>
</section>
</section>
<section id="funciones-de-densidad" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="funciones-de-densidad"><span class="header-section-number">15.2</span> Funciones de densidad</h2>
<p>Cuando trabajamos con mediciones de tipo continuo, es más conveniente definir asignaciones de probabilidad utilizando <em>funciones de densidad de probabilidad</em>:</p>
<div class="cell" type="comentario">

<div class="comentario">
<p>Una función <span class="math inline">\(f(x)\)</span> no negativa cuya integral es igual a 1 es una función de densidad de probabilidad. Las probabilidades asociadas se calculan integrando:</p>
<p><span class="math display">\[P(X\in [a,b]) = \int_a^b f(x)\,dx\]</span></p>
En este caso decimos que <span class="math inline">\(f\)</span> es la función de densidad de probabilidad asociada a la variable aleatoria <span class="math inline">\(X\)</span>. A este tipo de variables aleatorias les llamamos <em>continuas</em>.
</div>
</div>
</section>
<section id="ejemplo-densidad-triangular" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="ejemplo-densidad-triangular"><span class="header-section-number">15.3</span> Ejemplo: densidad triangular</h2>
<p>Supongamos que tenemos una variable aleatoria que tiene mediana 2, y puede tomar valores entre 0 y 4. Podríamos definir una densidad como sigue: Si <span class="math inline">\(x\)</span> está entre 0 y 2, entonces</p>
<p><span class="math display">\[f(x) = \frac{x}{4}\]</span></p>
<p>y si <span class="math inline">\(x\)</span> está entre 2 y 4, entonces</p>
<p><span class="math display">\[f(x) = 1 - \frac{x}{4}\]</span></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dens_triangular <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">4</span>) <span class="sc">*</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">2</span>, x<span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span> <span class="sc">-</span> x<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>triangular_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dens_triangular</span>(x)) </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(triangular_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<section id="ejemplo" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo">Ejemplo</h3>
<p>Supongamos que una variable <span class="math inline">\(X\)</span> tiene mediana 2 y rango de 0 a 4, con densidad triangular. ¿Cuál es la probabilidad <span class="math inline">\(P(X&gt;1)\)</span>?</p>
<p>Solución: Por reglas usuales de probabilidad, <span class="math inline">\(P(X&gt;1) = P(1&lt;X&lt;2) + P(X\geq2)\)</span>. Tenemos que <span class="math inline">\(P(X\geq 2) = 0.5\)</span>. Ahora usamos la fórmula de la densidad triangular para obtener</p>
<p><span class="math display">\[P(1&lt;X&lt;2) = \int_{1}^{2} f(x)\,dx = \int_1^2 \frac{x}{4}\,dx =
\left [\frac{x^2}{8}\right ]_1^2 = 1/2 - 1/8 = 3/8 = 0.375\]</span></p>
<p>de modo que</p>
<p><span class="math display">\[P(X&gt;1) = 0.375 +0.500 = 0.875\]</span></p>
<p>En general, podemos dar una fórmula para una densidad triangular en el intervalo <span class="math inline">\([A,B]\)</span> con mediana en <span class="math inline">\((A + B)/2\)</span>. ¿Cómo sería la fórmula?</p>
</section>
</section>
<section id="cuantiles-de-variables-aleatorias" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="cuantiles-de-variables-aleatorias"><span class="header-section-number">15.4</span> Cuantiles de variables aleatorias</h2>
<p>Antes vimos la definición de cuantiles para datos numéricos. Podemos definirlos también para variables aleatorias numéricas:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Cuantiles teóricos
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sea <span class="math inline">\(p\in (0,1)\)</span>. El cuantil-<span class="math inline">\(p\)</span> de la variable <span class="math inline">\(X\)</span> con función de densidad <span class="math inline">\(f(x)\)</span> es el valor <span class="math inline">\(x(p)\)</span> tal que</p>
<p><span class="math display">\[\int_{-\infty}^{x(p)} f(x)\,dx = p\]</span></p>
</div>
</div>
<p>Observación: nótese que usamos como límite inferior <span class="math inline">\(-\infty\)</span> para indicar que integramos <span class="math inline">\(f\)</span> sobre toda la densidad que esté a la izquierda de <span class="math inline">\(x(p)\)</span>.</p>
<section id="ejemplo-densidad-triangular-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo-densidad-triangular-1">Ejemplo: densidad triangular</h3>
<p>Supongamos que <span class="math inline">\(X\)</span> tiene la densidad triangular mostrada arriba. Calcula el cuartil inferior y superior (es decir, los cuantiles 0.25 y 0.75). Para el cuartil superior, por ejemplo, buscamos al <span class="math inline">\(x(0.75)\)</span> de la siguiente gráfica:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/triangular.R"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(triangular_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="fu">qtri</span>(<span class="fl">0.75</span>, <span class="dv">0</span>, <span class="dv">4</span>), x, <span class="dv">0</span>)), </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">qtri</span>(<span class="fl">0.75</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="fl">0.03</span>, <span class="at">label =</span> <span class="st">"x(0.75)"</span>) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="fu">qtri</span>(<span class="fl">0.75</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="fl">0.0</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comenzaremos por el cuartil inferior. Buscamos una <span class="math inline">\(x(0.25)\)</span> tal que</p>
<p><span class="math display">\[\int_0^{x(0.25)} f(x)\,dx = 0.25\]</span></p>
<p>Sabemos que <span class="math inline">\(x(0.25)&lt; 2\)</span>, pues la integral hasta 2 es 0.5, así que</p>
<p><span class="math display">\[\int_0^{x(0.25)} f(x)\,dx = \int_0^{x(0.25)} x/4 \,dx = \left [ x^2/8\right]_0^{x(0.25)} = (x(0.25))^2/8\]</span></p>
<p>Si queremos que este valor sea igual a 0.25, entonces despejando obtenemos</p>
<p><span class="math display">\[x(0.25) = \sqrt{0.25(8)} = \sqrt{2}\approx 1.4142\]</span></p>
<p>Ahora podríamos calcular la otra integral, pero por simetría podemos concluir que</p>
<p><span class="math display">\[x(0.75) = 2 + (2 - 1.4142) \approx 2.5858\]</span></p>
<p>y concluimos que los cuartiles inferiores y superiores son aproximadamente 1.41 y 2.59</p>
</section>
<section id="ejercicio-densidad-uniforme" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejercicio-densidad-uniforme">Ejercicio: densidad uniforme</h3>
<p>Calcula la mediana, y los percentiles 0.10 y 0.90 de una variable uniforme en <span class="math inline">\([0, 10]\)</span>.</p>
</section>
</section>
<section id="comparando-cuantiles-teóricos-y-empíricos" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="comparando-cuantiles-teóricos-y-empíricos"><span class="header-section-number">15.5</span> Comparando cuantiles teóricos y empíricos</h2>
<p>Los cuantiles que vimos en la parte de descriptivos para datos numéricos se llaman usualmente <em>cuantiles empíricos</em>. Estos cuantiles podemos compararlos con cuantiles teóricos para ver qué tan similares son, y si el modelo teórico describe adecuadamente los datos.</p>
<section id="ejemplo-distribución-uniforme" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="ejemplo-distribución-uniforme"><span class="header-section-number">15.5.1</span> Ejemplo: distribución uniforme</h3>
<p>Simularemos 500 datos uniformes en <span class="math inline">\([0, 10]\)</span>:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x_sim_u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Podríamos calcular algunos cuantiles empíricos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(x_sim_u, <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.50</span>, <span class="fl">0.90</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     10%      50%      90% 
1.024274 5.157881 8.832252 </code></pre>
</div>
</div>
<p>Por el ejercicio anterior sabemos cuáles son los cuantiles teóricos correspondientes a una uniforme en <span class="math inline">\([0,10]\)</span>. Podemos calcularlos también como sigue:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qunif</span>(<span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.5</span>, <span class="fl">0.90</span>), <span class="dv">0</span>, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 5 9</code></pre>
</div>
</div>
<p>Y vemos que son muy similares los cuantiles empíricos y teóricos. Una mejor manera de considerar esta similitud es graficando <em>todos</em> los cuantiles empíricos y comparándolos con los teóricos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> x_sim_u), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qunif, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Cuantiles Teóricos U(0,10)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Cuantiles de datos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y vemos que la forma de las dos distribuciones es muy similar: los cuantiles empíricos son muy similares a los teóricos. Existen algunas fluctuaciones debidas al muestreo aleatorio.</p>
</section>
<section id="ejemplo-distribución-triangular" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="ejemplo-distribución-triangular"><span class="header-section-number">15.5.2</span> Ejemplo: distribución triangular</h3>
<p>Repetimos para la distribución triangular. Los cuantiles que calculamos arriba son:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtri</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.414214 2.585786</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x_sim_tri <span class="ot">&lt;-</span> <span class="fu">rtri</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> x_sim_tri), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> qtri, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Cuantiles Teóricos triangular(0,4)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Cuantiles de datos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nótese que otra vez, los cuantiles teóricos se alinean bien con los teóricos.</p>
</section>
</section>
<section id="la-distribución-normal" class="level2" data-number="15.6">
<h2 data-number="15.6" class="anchored" data-anchor-id="la-distribución-normal"><span class="header-section-number">15.6</span> La distribución normal</h2>
<p>La distribución normal es una que aparece naturalmente en al teoría de probabilidad.</p>
<section id="promedio-de-variables" class="level3" data-number="15.6.1">
<h3 data-number="15.6.1" class="anchored" data-anchor-id="promedio-de-variables"><span class="header-section-number">15.6.1</span> Promedio de variables</h3>
<p>Consideremos que tiramos 40 dados justos de 6 lados, y consideramos su promedio <span class="math inline">\(\bar{X}\)</span> como resultado de nuestro experimento aleatorio. ¿Cómo se ve la distribución de probabilidades de esta variable <span class="math inline">\(\bar{X}\)</span>?</p>
<p>Comenzamos haciendo simulacion:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>simular_bolsa <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">num_dados =</span> <span class="dv">40</span>){</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num_dados, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    media <span class="ot">&lt;-</span> <span class="fu">mean</span>(dados)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    media</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">simular_bolsa</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.025</code></pre>
</div>
</div>
<p>Veamos cómo se ven los resultados si hacemos este experimento un número grande de veces:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sims_dados <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="sc">~</span> <span class="fu">simular_bolsa</span>())</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_dados), </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> resultado)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Y notamos una forma de “campana” interesante. Esto se explica porque típicamente tendremos tiros bajos y altos, de modo que muchos resultados de este experimento se concentran alrededor de la media de un dado (3.5). Además, existen fluctuaciones aleatorios, y a veces tenemos un poco más de tiros altos o de tiros bajos, de forma que existe dispersión alrededor de 3.5.</p>
<p>Sin embargo, estas desviaciones de 3.5 no pueden ser muy grandes: por ejemplo, para tener un promedio de 1, todas las tiradas de los 40 dados tendrían que dar 1, y eso es muy poco probable. Igualmente, para que el promedio fuera cercano a 6, la gran mayoría de los 40 dados deberían de dar 6, lo cual otra vez es muy poco probable. Esto explica al menos la forma general de la forma de las colas derecha e izquierda de esta distribución.</p>
<p>Los dados podrían ser diferentes (por ejemplo, un poco cargados a 1 o 6, o más cargados a valores centrales), y los argumentos de arriba también se cumplirían. Lo que es sorprendente es que, independientemente de cómo sean las particularidades de los dados, la forma analítica de esta distribución que acabamos de mostrar <strong>es la misma</strong>.</p>
<p>Esta forma está descrita por la densidad normal estándar:</p>
<p><span class="math display">\[f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\]</span></p>
<p>cuya gráfica presentamos a continuación:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>A una variable <span class="math inline">\(Z\)</span> que tiene esta densidad le llamamos una variable con <strong>distribución normal estándar</strong>. Comparemos cuantiles en nuestro ejemplo:</p>
<div class="cell">
<details open="">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_dados),</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> resultado)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Normal estándar teórica"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Promedio de 40 dados"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Y notamos que los cuantiles no corresponden, pero el espaciamiento entre los cuantiles de los datos y los teóricos de la normal estándar es el mismo. Quiere decir que estas dos distribuciones <strong>tienen la misma forma</strong>, aunque estén escaladas y centradas en distintos valores.</p>
<p>Probemos con promedios de 20 observaciones triangulares en <span class="math inline">\((0,1)\)</span> por ejemplo. El resultado es el mismo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>sims_tri <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">rtri</span>(<span class="dv">20</span>, <span class="dv">0</span> ,<span class="dv">1</span>)))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_tri), </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> resultado)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_tri),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> resultado)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Normal estándar teórica"</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Promedio de 20 triangulares (0,1)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Otra vez, la forma general es la misma, aún cuando los datos están centrados y escalados de manera distinta.</p>
</section>
</section>
<section id="la-densidad-normal-estándar" class="level2" data-number="15.7">
<h2 data-number="15.7" class="anchored" data-anchor-id="la-densidad-normal-estándar"><span class="header-section-number">15.7</span> La densidad normal estándar</h2>
<p>Como expicamos, la densidad normal estándar está dada por</p>
<p><span class="math display">\[f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}},\]</span></p>
<p>cuya gráfica es como sigue:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>normal_std_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_std_graf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Las probabilidades asociadas a una normal estándar se calculan integrando esta curva (que tiene que hacerse de forma numérica). Por ejemplo, para calcular</p>
<p><span class="math display">\[P(Z &lt; 1.5),\]</span></p>
<p>podemos usar</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9331928</code></pre>
</div>
</div>
<p>Que es el área bajo la curva mostrada abajo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>normal_std_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.005</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_std_graf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">3.5</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="fl">1.5</span>, x, <span class="dv">0</span>)), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.5</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Esta es la forma de la densidad estándar. Podemos centrar esta campana en otro valor <span class="math inline">\(\mu\)</span> y aumentar la dispersión por un factor <span class="math inline">\(\sigma\)</span>. Si <span class="math inline">\(Z\)</span> es una variable normal estándar, la variable</p>
<p><span class="math display">\[X = \mu + \sigma Z\]</span></p>
<p>es una variable <strong>normal</strong> con parámetros <span class="math inline">\((\mu, \sigma)\)</span>, o de manera más compacta, decimos que <span class="math inline">\(X\)</span> es <span class="math inline">\(N(\mu, \sigma)\)</span>. La distribución normal estándar es <span class="math inline">\(N(0,1)\)</span>.</p>
<p>Por ejemplo, si escogemos <span class="math inline">\(\mu=5\)</span> y <span class="math inline">\(\sigma = 0.5\)</span>, obtenemos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>normal_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="dv">5</span>, <span class="fl">0.5</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_graf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Podemos mostrar juntas estas dos distribuciones:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>densidad_normal <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">densidad =</span> <span class="fu">dnorm</span>(x, <span class="dv">5</span>, <span class="fl">0.5</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>densidad_normal_estandar <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">densidad =</span> <span class="fu">dnorm</span>(x))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>g_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(densidad_normal_estandar, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> densidad)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>g_3 <span class="ot">&lt;-</span> g_2 <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(densidad_normal, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> densidad)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>g_3 <span class="sc">+</span> g_1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede demostrar que:</p>
<div class="cell" type="comentario">

<div class="comentario">
<p><strong>Distribución normal</strong></p>
<ul>
<li>La distribución normal estándar <span class="math inline">\(N(0,1)\)</span> tiene media 0 y desviación estándar 1</li>
<li>La distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span> tiene media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma\)</span></li>
</ul>
</div>
</div>
</section>
<section id="cuantiles-y-concentración-de-la-densidad-normal" class="level2" data-number="15.8">
<h2 data-number="15.8" class="anchored" data-anchor-id="cuantiles-y-concentración-de-la-densidad-normal"><span class="header-section-number">15.8</span> Cuantiles y concentración de la densidad normal</h2>
<p>Con un poco de cálculo podemos ver qué tan fuertemente se concentra la densidad alrededor de la media para una distribución normal. La regla es la siguiente:</p>
<ul>
<li>68% de la densidad se concentra en el intervalo <span class="math inline">\([\mu-\sigma, \mu+\sigma]\)</span></li>
<li>95% de la densidad se concentra en el intervalo <span class="math inline">\([\mu-2\sigma, \mu+2\sigma]\)</span></li>
<li>99.7% de la densidad se concentra en el intervalo <span class="math inline">\([\mu-3\sigma, \mu+3\sigma]\)</span></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>grafica_concentracion <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, z){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(mu <span class="sc">-</span> <span class="fl">3.1</span> <span class="sc">*</span> sigma, mu <span class="sc">+</span> <span class="fl">3.1</span> <span class="sc">*</span> sigma, <span class="fl">0.01</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  valor <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, sigma)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span><span class="ot">=</span>valor)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(<span class="fu">pnorm</span>(z) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>z)), <span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">paste0</span>(texto, <span class="st">"%"</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">filter</span>(datos, x <span class="sc">&lt;</span> mu <span class="sc">+</span> z<span class="sc">*</span>sigma, x <span class="sc">&gt;</span> mu <span class="sc">-</span> z<span class="sc">*</span>sigma), </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"salmon"</span>) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mu, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> texto) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> mu <span class="sc">+</span> sigma<span class="sc">*</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>g_68 <span class="ot">&lt;-</span> <span class="fu">grafica_concentracion</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>g_95 <span class="ot">&lt;-</span> <span class="fu">grafica_concentracion</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>g_997 <span class="ot">&lt;-</span> <span class="fu">grafica_concentracion</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>paneles <span class="ot">&lt;-</span> g_68 <span class="sc">+</span> g_95 <span class="sc">+</span> g_997</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>paneles <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Concentración alrededor de la media (normal)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p><strong>Nota</strong>: esto aplica para cualquier densidad normal, independientemente de los parámetros.</p>
<p>Obsérvese que esto nos da una interpretación natural de la desviación estándar de una distribución normal en términos de percentiles de los datos, y la manera usual con la que entendemos la desviación estándar de la distribución normal.</p>
</section>
<section id="el-teorema-central-del-límite" class="level2" data-number="15.9">
<h2 data-number="15.9" class="anchored" data-anchor-id="el-teorema-central-del-límite"><span class="header-section-number">15.9</span> El teorema central del límite</h2>
<p>Una de las razones por las que el modelo normal es tan importante es el siguiente resultado:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Teorema central del límite
</div>
</div>
<div class="callout-body-container callout-body">
<p>Si <span class="math inline">\(X_1,X_2,\ldots, X_n\)</span> son variables aleatorias independientes con media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma\)</span> con una densidad <span class="math inline">\(f(x)\)</span>:</p>
<ul>
<li><span class="math inline">\(S_n = X_1 + X_2 + \cdots X_n\)</span> es aproximadamente normal cuando <span class="math inline">\(n\)</span> es suficientemente grande</li>
</ul>
</div>
</div>
<ul>
<li>Muchas cantidades de interés en la estadística se pueden definir como sumas o promedios de un número grande de variables aleatorias (por ejempo, cuando queremos estimar el total de ingreso de los hogares, estatura promedio en una población, etc.) Los percentiles de una muestra grande también cumplen un teorema central del límite de este tipo.</li>
<li>La aproximación del teorema central del límite mejora cuando <span class="math inline">\(n\)</span> es más grande. Aunque una regla de dedo dice que <span class="math inline">\(n\geq 30\)</span> es suficiente para muchas distribuciones, puede ser que sea necesaria usar una <span class="math inline">\(n\)</span> más grande.</li>
</ul>
<p>Esto nos permite, por ejemplo, considerar nuestro primera técnica de estimación por intervalos:</p>
<ul>
<li>Observamos una muestra grande <span class="math inline">\(x_1,\ldots, x_n\)</span> de datos de una población (no necesariamente con distribución normal). Supongamos que buscamos estimar la media <span class="math inline">\(\mu\)</span> de la población con un intervalo.</li>
<li>Estimamos la media con</li>
</ul>
<p><span class="math display">\[\bar{x} = \frac{1}{n}(x_1+\cdots + x_n) = \frac{1}{n}\sum_i x_i,\]</span></p>
<ul>
<li>Por el teorema del límite central, <span class="math inline">\(\bar{x}\)</span> es aproximadamente normal, y su media es <span class="math inline">\(\mu\)</span>. Esto implica que</li>
</ul>
<p><span class="math display">\[P(\mu - 2\sigma  \leq \bar{x} \leq\mu + 2\sigma)\approx 0.95\]</span></p>
<p>Despejando <span class="math inline">\(\mu\)</span> obtenemos</p>
<p><span class="math display">\[P(\bar{x} - 2\sigma  \leq \mu  \leq\bar{x} + 2\sigma)\approx 0.95\]</span></p>
<p>Finalmente, no conocemos <span class="math inline">\(\sigma\)</span>, pero la estimamos con</p>
<p><span class="math display">\[\hat{\sigma}^2 = \frac{1}{n}((x_1 - \bar{x})^2 + \dots + (x_n - \bar{x})^2) = \frac{1}{n}\sum_i(x_i - \bar{x})^2\]</span></p>
<p>Y aproximamos sustituyendo nuestra estimación:</p>
<p><span class="math display">\[P(\bar{x} - 2\hat{\sigma } \leq \mu  \leq\bar{x} + 2\hat{\sigma})\approx 0.95\]</span></p>
<p>Esto nos da un intervalo (llamado el <strong>intervalo de Wald</strong>) con 95% de confianza para la media poblacional:</p>
<p><span class="math display">\[[\bar{x} - 2\hat{\sigma }  , \bar{x} + 2\hat{\sigma}]\]</span></p>
<p>Notas:</p>
<ul>
<li>Por otras razones técnicas, a veces se usa <span class="math inline">\(s^2 = \frac{1}{n-1}\sum_i (x_i-\bar{x})^2\)</span> en lugar de <span class="math inline">\(\hat{\sigma}^2\)</span>. Si la muestra es grande esto no es importante.</li>
<li>Estos intervalos tienen cobertura <em>nominal</em> de 95%, sin embargo, puede variar dependiendo del tamaño de muestra y la forma de la distribución teórica (poblacional). Existen métodos como el <em>bootstrap</em> donde podemos checar qué tan razonable es hacer esta aproximación. También se puede hacer simulación modelando la distribución <span class="math inline">\(f(x)\)</span>.</li>
</ul>
</section>
<section id="máxima-verosimilitud-modelos-continuos" class="level2" data-number="15.10">
<h2 data-number="15.10" class="anchored" data-anchor-id="máxima-verosimilitud-modelos-continuos"><span class="header-section-number">15.10</span> Máxima verosimilitud: modelos continuos</h2>
<p>Supongamos que queremos queremos modelar la estatura de cantantes tenores y sopranos en una población, y tomamos una muestra aleatoria. Nuestro primer supuesto será que los datos de ambas poblaciones se distribuyen de manera aproximadamente normal, con medias distintas pero la misma dispersión.</p>
<p>Nuestro modelo es entonces:</p>
<ul>
<li>Para sopranos, <span class="math inline">\(y \sim N(\mu_s, \sigma)\)</span>,</li>
<li>Para tenores, <span class="math inline">\(y \sim N(\mu_t, \sigma)\)</span>.</li>
</ul>
<p>Si tomamos muestras aleatorias independientes de estos dos grupos, y denotaremos las estaturas registradas como:</p>
<p><span class="math display">\[y_1, y_2, \ldots, y_n\]</span></p>
<p>y la tesitura del cantante como</p>
<p><span class="math display">\[s_1,s_2,\ldots, s_n\]</span></p>
<p>donde <span class="math inline">\(s_i=1\)</span> indica soprano y <span class="math inline">\(s_i=0\)</span> indica tenor. Escribimos nuestra verosimilitud, que en este caso consiste en multipicar las funciones de densidad normal correspondientes. Por ejemplo, si tenemos <span class="math inline">\(n=3\)</span>, <span class="math inline">\(y_1 = 160, s_1=0\)</span> y <span class="math inline">\(y_2 = 150, y_3 = 162, s_2=1, s_3 = 1,\)</span> y <span class="math inline">\(f(x;\mu,\sigma)\)</span> es la función de densidad normal, podríamos escribir la verosimilitud como</p>
<p><span class="math display">\[L(\mu_1, \mu_2, \sigma; y) = f\left(160; \mu_t,\sigma\right)f\left(150;   \mu_s,\sigma\right)f\left(162; \mu_s, \sigma\right)\]</span></p>
<p>En general, podemos escribir la log verosimilitud como (aunque con algo de trabajo puede simplificarse a una versión numéricamente más conveniente):</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>crear_log_verosim <span class="ot">&lt;-</span> <span class="cf">function</span>(y, s){</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  log_verosim <span class="ot">&lt;-</span> <span class="cf">function</span>(pars){</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    mu_s <span class="ot">&lt;-</span> pars[<span class="dv">1</span>]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    mu_t <span class="ot">&lt;-</span> pars[<span class="dv">2</span>]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> pars[<span class="dv">3</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">dnorm</span>(y, <span class="at">mean =</span> mu_s <span class="sc">*</span> s <span class="sc">+</span> mu_t <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> s), sigma, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    res</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  log_verosim</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nuestra muestra es:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32413</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>cantantes <span class="ot">&lt;-</span> lattice<span class="sc">::</span>singer <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estatura_cm =</span> <span class="fu">round</span>(<span class="fl">2.54</span> <span class="sc">*</span> height)) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(voice.part, <span class="st">"Tenor|Soprano"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(voice.part) <span class="sc">|&gt;</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tesitura =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(voice.part, <span class="st">"Tenor"</span>), <span class="st">"tenor"</span>, <span class="st">"soprano"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tesitura, estatura_cm)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>cantantes <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tesitura, <span class="at">y =</span> estatura_cm)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Estimamos las medias y desviación estándar con máxima verosimilitud:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> cantantes<span class="sc">$</span>estatura_cm</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> (cantantes<span class="sc">$</span>tesitura <span class="sc">==</span> <span class="st">"soprano"</span>) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>log_vero <span class="ot">&lt;-</span> <span class="fu">crear_log_verosim</span>(y, s)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>res_mv <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">30</span>), log_vero,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">2000</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>est_mv <span class="ot">&lt;-</span> res_mv<span class="sc">$</span>par</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>est_mv <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 162.33 176.32   6.08</code></pre>
</div>
</div>
<p>Y construimos intervalos de confianza utilizando el bootstrap paramétrico. Sin embargo, deberíamos checar nuestro modelo antes de proseguir. Si el ajuste del modelo es malo, es posible que nuestros intervalos no tengan una cobertura cercana a la nominal.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Checando modelos
</div>
</div>
<div class="callout-body-container callout-body">
<p>Una estrategia general para checar ajuste de modelos es generar datos a partir del modelo estimado. Así, estos datos generados por los modelos pueden ser contrastados con los datos reales para encontrar desviaciones importantes que puedan afectar la inferencia.</p>
<p>La simulación debe incluir la incertidumbre que tenemos acerca de los parámetros del modelo, de forma que podemos usar el bootstrap paramétrico para incorporar esta incertidumbre.</p>
</div>
</div>
<p>En nuestro caso, tenemos las siguentes funciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>generar_muestra <span class="ot">&lt;-</span> <span class="cf">function</span>(s, mu_s, mu_t, sigma){</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(s), mu_s <span class="sc">*</span> s <span class="sc">+</span> mu_t <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> s), sigma)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">s =</span> s, <span class="at">estatura_cm =</span> y)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>generar_muestra_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(s, est_mv){</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># muestrear del modelo ajustado</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  muestra_boot <span class="ot">&lt;-</span> <span class="fu">generar_muestra</span>(s, est_mv[<span class="dv">1</span>], est_mv[<span class="dv">2</span>], est_mv[<span class="dv">3</span>])</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reestimar parámetros</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> muestra_boot<span class="sc">$</span>estatura_cm</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> muestra_boot<span class="sc">$</span>s</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  log_boot_vero <span class="ot">&lt;-</span> <span class="fu">crear_log_verosim</span>(y, s)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  res_boot_mv <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">30</span>), log_boot_vero,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>))</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  est_mv <span class="ot">&lt;-</span> res_boot_mv<span class="sc">$</span>par</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generar_muestra</span>(s, est_mv[<span class="dv">1</span>], est_mv[<span class="dv">2</span>], est_mv[<span class="dv">3</span>])</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y las utilizamos para generar muestras. Nótese que redondeamos para usar la misma precisión de los datos originales:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>muestras_tbl <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>, <span class="cf">function</span>(rep) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generar_muestra_boot</span>(s, est_mv) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">estatura_cm =</span> <span class="fl">2.54</span> <span class="sc">*</span> <span class="fu">round</span>(estatura_cm<span class="sc">/</span><span class="fl">2.54</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">rep =</span> rep)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>muestras_tbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(muestras_tbl, cantantes <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">mutate</span>(<span class="at">rep =</span> <span class="dv">20</span>, <span class="at">s =</span> <span class="fu">ifelse</span>(tesitura <span class="sc">==</span> <span class="st">"soprano"</span>,<span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(muestras_tbl, <span class="fu">aes</span>(<span class="at">sample =</span> estatura_cm, <span class="at">colour =</span> <span class="fu">factor</span>(s))) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span> rep)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="05-prob-modelos-continuos_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Notamos que no hay desjustes grandes de nuestro modelo. En primer lugar, el supuesto de normalidad parece consistente con los datos a grandes rasgos. Nuestra hipótesis de igualdad de varianzas parece sostenerse razonablemente bien, aunque es posible que la dispersión en los tenores sea un poco mayor que en las sopranos.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Prueba con un modelo que no suponga la misma varianza para los dos grupos, y discute ventajas y desventajas.</p>
</div>
</div>
<p>Finalmente, construimos intervalos del 95% para cada uno de los parámetros:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>parametros_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(s, est_mv){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># muestrear del modelo ajustado</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  muestra_boot <span class="ot">&lt;-</span> <span class="fu">generar_muestra</span>(s, est_mv[<span class="dv">1</span>], est_mv[<span class="dv">2</span>], est_mv[<span class="dv">3</span>])</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reestimar parámetros</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> muestra_boot<span class="sc">$</span>estatura_cm</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> muestra_boot<span class="sc">$</span>s</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  log_boot_vero <span class="ot">&lt;-</span> <span class="fu">crear_log_verosim</span>(y, s)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  res_boot_mv <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">30</span>), log_boot_vero,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">list</span>(<span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1000</span>))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  est_boot_mv <span class="ot">&lt;-</span> res_boot_mv<span class="sc">$</span>par</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">mu_s =</span> est_boot_mv[<span class="dv">1</span>], <span class="at">mu_t =</span> est_boot_mv[<span class="dv">2</span>], <span class="at">sigma =</span> est_boot_mv[<span class="dv">3</span>])</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>remuestreo_tbl <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="sc">~</span> <span class="fu">parametros_boot</span>(s, est_mv))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>remuestreo_tbl <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(mu_s<span class="sc">:</span>sigma, <span class="at">names_to =</span> <span class="st">"parametro"</span>, <span class="at">values_to =</span> <span class="st">"valor"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(parametro) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">inf_5 =</span> <span class="fu">quantile</span>(valor, <span class="fl">0.05</span>), <span class="at">inf_95 =</span> <span class="fu">quantile</span>(valor, <span class="fl">0.95</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">1</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  parametro inf_5 inf_95
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
1 mu_s      161.   164. 
2 mu_t      175.   178. 
3 sigma       5.2    6.7</code></pre>
</div>
</div>
</section>
<section id="resumen" class="level2" data-number="15.11">
<h2 data-number="15.11" class="anchored" data-anchor-id="resumen"><span class="header-section-number">15.11</span> Resumen</h2>
<ul>
<li><p>En las secciones anteriores, definimos modelos de probabilidad para datos observados (de tipo discreto y continuo).</p></li>
<li><p>Estos modelos dependen generalmente de parámetros desconocidos poblacionales (como probabilidad de ser seropositivo, o medias y dispersión de la población de cantantes).</p></li>
<li><p>Las cantidades de interés ahora son esos parámetros del modelo de probabilidad, y queremos hacer inferencia sobre ellos.</p></li>
<li><p>Introdujimos el método de máxima verosimilitud como una manera general de encontrar estimadores de esos parámetros dada una muestra, y vimos cómo construir intervalos de confianza usando el bootstrap paramétrico.</p></li>
<li><p>Mostramos un ejemplo simple de cómo checar los supuestos del modelo para saber si podemos confiar en la inferencia.</p></li>
<li><p>Nota: en lugar de utilizar el bootstrap paramétrico, es posible utilizar resultados asintóticos (como el teorema central del límite) para hacer inferencia.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-maxima-verosimilitud-1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Estimación por máxima verosimilitud</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-inferencia-modelos.html" class="pagination-link">
        <span class="nav-page-text">Inferencia con modelos bayesianos</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>