<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Pensamiento estadístico - 10&nbsp; Modelos probabilísticos para variables continuas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./inferencia-modelos.html" rel="next">
<link href="./prob-condicional.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sín resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modelos probabilísticos para variables continuas</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pensamiento estadístico</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Acerca del curso</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">Estadística y ciencia de datos</span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./resumenes.html" class="sidebar-item-text sidebar-link">Resúmenes y descripciones de datos</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analisis-resumenes-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Resúmenes para datos numéricos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analisis-resumenes-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Datos univariados categóricos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./intro-inferencia.html" class="sidebar-item-text sidebar-link">Inferencia estadística</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-pruebas-hipotesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introducción a pruebas de hipótesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pruebas-hipotesis-aleatorizacion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Aleatorización en inferencia causal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pruebas-hipotesis-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Más de pruebas de hipótesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimacion-aleatorizacion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inferencia por intervalos</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./remuestreo-bootstrap.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Remuestreo: el bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./probabilidad.html" class="sidebar-item-text sidebar-link">Introducción a teoría de probabilidades</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelo-prob.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Básicos de probabilidad y simulación</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob-condicional.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probabilidad condicional e independencia</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelos-continuos.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modelos probabilísticos para variables continuas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inferencia-modelos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Inferencia con modelos probabilísticos</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./inferencia-bayesiana.html" class="sidebar-item-text sidebar-link">Estadística Bayesiana</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-bayesiana-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introducción a inferencia bayesiana</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-bayesiana-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Calibración bayesiana y Regularización</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Indice de contenidos</h2>
   
  <ul>
  <li><a href="#ejemplo-ruleta-justa" id="toc-ejemplo-ruleta-justa" class="nav-link active" data-scroll-target="#ejemplo-ruleta-justa"> <span class="header-section-number">10.0.1</span> Ejemplo: ruleta justa</a></li>
  <li><a href="#modelo-equiprobable-o-uniforme" id="toc-modelo-equiprobable-o-uniforme" class="nav-link" data-scroll-target="#modelo-equiprobable-o-uniforme"> <span class="header-section-number">10.1</span> Modelo equiprobable o uniforme</a>
  <ul class="collapse">
  <li><a href="#ejemplo-ruleta-sesgada" id="toc-ejemplo-ruleta-sesgada" class="nav-link" data-scroll-target="#ejemplo-ruleta-sesgada"> <span class="header-section-number">10.1.1</span> Ejemplo: ruleta sesgada</a></li>
  </ul></li>
  <li><a href="#funciones-de-densidad" id="toc-funciones-de-densidad" class="nav-link" data-scroll-target="#funciones-de-densidad"> <span class="header-section-number">10.2</span> Funciones de densidad</a></li>
  <li><a href="#ejemplo-densidad-triangular" id="toc-ejemplo-densidad-triangular" class="nav-link" data-scroll-target="#ejemplo-densidad-triangular"> <span class="header-section-number">10.3</span> Ejemplo: densidad triangular</a>
  <ul class="collapse">
  <li><a href="#ejemplo" id="toc-ejemplo" class="nav-link" data-scroll-target="#ejemplo">Ejemplo</a></li>
  </ul></li>
  <li><a href="#cuantiles-de-variables-aleatorias" id="toc-cuantiles-de-variables-aleatorias" class="nav-link" data-scroll-target="#cuantiles-de-variables-aleatorias"> <span class="header-section-number">10.4</span> Cuantiles de variables aleatorias</a>
  <ul class="collapse">
  <li><a href="#ejemplo-densidad-triangular-1" id="toc-ejemplo-densidad-triangular-1" class="nav-link" data-scroll-target="#ejemplo-densidad-triangular-1">Ejemplo: densidad triangular</a></li>
  <li><a href="#ejercicio-densidad-uniforme" id="toc-ejercicio-densidad-uniforme" class="nav-link" data-scroll-target="#ejercicio-densidad-uniforme">Ejercicio: densidad uniforme</a></li>
  </ul></li>
  <li><a href="#comparando-cuantiles-teóricos-y-empíricos" id="toc-comparando-cuantiles-teóricos-y-empíricos" class="nav-link" data-scroll-target="#comparando-cuantiles-teóricos-y-empíricos"> <span class="header-section-number">10.5</span> Comparando cuantiles teóricos y empíricos</a>
  <ul class="collapse">
  <li><a href="#ejemplo-distribución-uniforme" id="toc-ejemplo-distribución-uniforme" class="nav-link" data-scroll-target="#ejemplo-distribución-uniforme"> <span class="header-section-number">10.5.1</span> Ejemplo: distribución uniforme</a></li>
  <li><a href="#ejemplo-distribución-triangular" id="toc-ejemplo-distribución-triangular" class="nav-link" data-scroll-target="#ejemplo-distribución-triangular"> <span class="header-section-number">10.5.2</span> Ejemplo: distribución triangular</a></li>
  </ul></li>
  <li><a href="#histogramas-y-densidades" id="toc-histogramas-y-densidades" class="nav-link" data-scroll-target="#histogramas-y-densidades"> <span class="header-section-number">10.6</span> Histogramas y densidades</a></li>
  <li><a href="#más-descriptivos-media-y-desviación-estándar" id="toc-más-descriptivos-media-y-desviación-estándar" class="nav-link" data-scroll-target="#más-descriptivos-media-y-desviación-estándar"> <span class="header-section-number">10.7</span> Más descriptivos: media y desviación estándar</a>
  <ul class="collapse">
  <li><a href="#media-teórica-y-empírica" id="toc-media-teórica-y-empírica" class="nav-link" data-scroll-target="#media-teórica-y-empírica"> <span class="header-section-number">10.7.1</span> Media teórica y empírica</a></li>
  <li><a href="#varianza-y-desviación-estándar" id="toc-varianza-y-desviación-estándar" class="nav-link" data-scroll-target="#varianza-y-desviación-estándar"> <span class="header-section-number">10.7.2</span> Varianza y desviación estándar</a></li>
  <li><a href="#notación" id="toc-notación" class="nav-link" data-scroll-target="#notación">Notación</a></li>
  <li><a href="#cuándo-usar-media-y-desviación-estándar" id="toc-cuándo-usar-media-y-desviación-estándar" class="nav-link" data-scroll-target="#cuándo-usar-media-y-desviación-estándar"> <span class="header-section-number">10.7.3</span> ¿Cuándo usar media y desviación estándar?</a></li>
  <li><a href="#ejercicio" id="toc-ejercicio" class="nav-link" data-scroll-target="#ejercicio">Ejercicio</a></li>
  </ul></li>
  <li><a href="#la-distribución-normal" id="toc-la-distribución-normal" class="nav-link" data-scroll-target="#la-distribución-normal"> <span class="header-section-number">10.8</span> La distribución normal</a>
  <ul class="collapse">
  <li><a href="#promedio-de-variables" id="toc-promedio-de-variables" class="nav-link" data-scroll-target="#promedio-de-variables"> <span class="header-section-number">10.8.1</span> Promedio de variables</a></li>
  </ul></li>
  <li><a href="#la-densidad-normal-estándar" id="toc-la-densidad-normal-estándar" class="nav-link" data-scroll-target="#la-densidad-normal-estándar"> <span class="header-section-number">10.9</span> La densidad normal estándar</a></li>
  <li><a href="#cuantiles-y-concentración-de-la-densidad-normal" id="toc-cuantiles-y-concentración-de-la-densidad-normal" class="nav-link" data-scroll-target="#cuantiles-y-concentración-de-la-densidad-normal"> <span class="header-section-number">10.10</span> Cuantiles y concentración de la densidad normal</a></li>
  <li><a href="#el-teorema-central-del-límite" id="toc-el-teorema-central-del-límite" class="nav-link" data-scroll-target="#el-teorema-central-del-límite"> <span class="header-section-number">10.11</span> El teorema central del límite</a></li>
  <li><a href="#otras-densidades-comunes" id="toc-otras-densidades-comunes" class="nav-link" data-scroll-target="#otras-densidades-comunes"> <span class="header-section-number">10.12</span> Otras densidades comunes</a>
  <ul class="collapse">
  <li><a href="#variables-aleatorias-exponenciales" id="toc-variables-aleatorias-exponenciales" class="nav-link" data-scroll-target="#variables-aleatorias-exponenciales"> <span class="header-section-number">10.12.1</span> Variables aleatorias exponenciales</a></li>
  <li><a href="#ejemplo-exponencial" id="toc-ejemplo-exponencial" class="nav-link" data-scroll-target="#ejemplo-exponencial"> <span class="header-section-number">10.12.2</span> Ejemplo: exponencial</a></li>
  <li><a href="#variables-aleatorias-gamma" id="toc-variables-aleatorias-gamma" class="nav-link" data-scroll-target="#variables-aleatorias-gamma"> <span class="header-section-number">10.12.3</span> Variables aleatorias gamma</a></li>
  </ul></li>
  <li><a href="#modelos-conjuntos-de-probabilidad" id="toc-modelos-conjuntos-de-probabilidad" class="nav-link" data-scroll-target="#modelos-conjuntos-de-probabilidad"> <span class="header-section-number">10.13</span> Modelos conjuntos de probabilidad</a></li>
  <li><a href="#estaturas-modelando-relaciones-de-dependencia" id="toc-estaturas-modelando-relaciones-de-dependencia" class="nav-link" data-scroll-target="#estaturas-modelando-relaciones-de-dependencia"> <span class="header-section-number">10.14</span> Estaturas: modelando relaciones de dependencia</a></li>
  <li><a href="#distribuciones-condicionales" id="toc-distribuciones-condicionales" class="nav-link" data-scroll-target="#distribuciones-condicionales"> <span class="header-section-number">10.15</span> Distribuciones condicionales</a></li>
  <li><a href="#estaturas-variación-gamma" id="toc-estaturas-variación-gamma" class="nav-link" data-scroll-target="#estaturas-variación-gamma"> <span class="header-section-number">10.16</span> Estaturas: variación gamma</a></li>
  <li><a href="#modelos-conjuntos-para-factor-categórico" id="toc-modelos-conjuntos-para-factor-categórico" class="nav-link" data-scroll-target="#modelos-conjuntos-para-factor-categórico"> <span class="header-section-number">10.17</span> Modelos conjuntos para factor categórico</a>
  <ul class="collapse">
  <li><a href="#ejemplo-cuentas-y-propinas" id="toc-ejemplo-cuentas-y-propinas" class="nav-link" data-scroll-target="#ejemplo-cuentas-y-propinas"> <span class="header-section-number">10.17.1</span> Ejemplo: cuentas y propinas</a></li>
  </ul></li>
  <li><a href="#modelos-multivariados" id="toc-modelos-multivariados" class="nav-link" data-scroll-target="#modelos-multivariados"> <span class="header-section-number">10.18</span> Modelos multivariados</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Modelos probabilísticos para variables continuas</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>En la parte anterior consideramos un númeroo fijo de resultados numéricos de experimentos aleatorios, por ejemplo, cuando <span class="math inline">\(X\)</span> el resultado de una tirada de dado. En este caso, un modelo de probabilidad para <span class="math inline">\(X\)</span> asigna una probabilidad dada a cada posible resultado, por ejemplo</p>
<p><span class="math display">\[P(X=1) = 1/6\]</span></p>
<p>e igualmente <span class="math inline">\(P(X=2)=\cdots = P(X=6) = 1/6\)</span>. En muchos casos, la cantidad <span class="math inline">\(X\)</span> que nos interesa puede tomar valores numéricos arbitrarios, y en este esquema no está claro cómo asignaríamos probabilidades.</p>
<section id="ejemplo-ruleta-justa" class="level3" data-number="10.0.1">
<h3 data-number="10.0.1" class="anchored" data-anchor-id="ejemplo-ruleta-justa"><span class="header-section-number">10.0.1</span> Ejemplo: ruleta justa</h3>
<p>Supongamos que giramos una ruleta con una flecha indicadora, y el resultado del experimento es el ángulo en grados final de la flecha. ¿Cómo podríamos poner, por ejemplo <span class="math inline">\(P(X= 92.7)\)</span>? ¿Qué pasa si podemos medir con resultados con varios decimales de exactitud?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imagenes/ruleta.jpeg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Ruleta</figcaption><p></p>
</figure>
</div>
<p>En estos casos, en lugar de considerar eventos de la forma <span class="math inline">\(X=a\)</span>, podemos considerar eventos resultantes de la forma <span class="math inline">\(a\leq X \leq b\)</span>, es decir, buscamos asignar probabilidades a eventos de la forma</p>
<p><span class="math display">\[P(X \in [a,b]).\]</span></p>
<p>Por ejemplo, si <span class="math inline">\(Y\)</span> es la estatura adulta de una persona que acaba de nacer, podríamos preguntarnos cómo asignar probabilidades a eventos como</p>
<p><span class="math display">\[P(Y\in [150,170]) = P(150\leq Y \leq 170),\]</span></p>
<p>y quizá también otros como</p>
<p><span class="math display">\[P(Y &lt; 180).\]</span></p>
</section>
<section id="modelo-equiprobable-o-uniforme" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="modelo-equiprobable-o-uniforme"><span class="header-section-number">10.1</span> Modelo equiprobable o uniforme</h2>
<p>Los modelos más simple para una medición continua <span class="math inline">\(X\)</span> son los modelos uniforme.</p>
<p>Para nuestra ruleta, por ejemplo, <span class="math inline">\(X\)</span> puede tomar valores en el intervalo <span class="math inline">\([0, 360)\)</span>. Si la ruleta es justa, entonces la probabilidad de que la flecha caiga en cualquier sector <span class="math inline">\([a,b]\)</span> debe ser igual. Una manera de lograr esto usar como probabilidad la proporción de la longitud de <span class="math inline">\([a,b]\)</span> con respecto al total de <span class="math inline">\([0, 360)\)</span>:</p>
<p><span class="math inline">\(P(X\in [a,b]) = \frac{b-a}{360}.\)</span></p>
<ul>
<li>Discute por qué esta asignación de probabilidades satisface las tres reglas básicas de probabilidad (axiomas) que presentamos anteriormente.</li>
<li>Este es el equivalente continuos para espacios equiprobables con un número finito de resultados.</li>
</ul>
::: {.cell type=‘comentario’}
<div class="comentario">
<p>Supongamos que una variable aleatoria puede tomar valores en el intervalo <span class="math inline">\([L,U]\)</span>. La variable aleatoria es <strong>uniforme</strong> en <span class="math inline">\([L,U]\)</span> cuando</p>
<p><span class="math display">\[P(X \in [a,b]) = \frac{b-a}{L-U}\]</span></p>
<pre><code>&lt;/div&gt;\EndKnitrBlock{comentario}</code></pre>
<p>:::</p>
<section id="ejemplo-ruleta-sesgada" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="ejemplo-ruleta-sesgada"><span class="header-section-number">10.1.1</span> Ejemplo: ruleta sesgada</h3>
<p>Ahora supongamos que nuestra ruleta no está del todo balanceada. Por ejemplo, podría ser estuviera colgada en una pared, y al girar la flecha es un poco más probable que la flecha apunte hacia el piso en lugar de hacia el cielo.</p>
<p>En este caso, si la dirección hacia arriba es 90 grados y hacia abajo es 270 grados, quisiéramos por ejemplo que</p>
<p><span class="math display">\[P(260 &lt; X &lt;280) &lt; P(80 &lt; X &lt; 100)\]</span></p>
<p>Y nótese que debe ser posible asignar probabilidades a cualquier sector de la ruleta con el nuevo modelo que propongamos. ¿Cómo podríamos modificar nuestra asignación de probabilidades?</p>
<p>Una de las maneras más fáciles es pensando que nuestra probabilidad se obtiene integrando una funcion constante:</p>
<ul>
<li>Si <span class="math inline">\([a,b]\)</span> es un sector de la ruleta con <span class="math inline">\(a&lt;b\)</span>, podríamos poner</li>
</ul>
<p><span class="math display">\[P(X\in [a,b]) = \int_a^b \frac{1}{360} \,dx = \frac{b-a}{360}\]</span></p>
<p>De forma que si <span class="math inline">\(f(x)= 1/360\)</span> para valores <span class="math inline">\(0 \leq x &lt; 360\)</span>, nuestra probabilidad se escribe como la integral</p>
<p><span class="math display">\[P(X\in [a,b]) = \int_a^b f(x) \,dx \]</span></p>
<ul>
<li>En este caso, probabilidad es área bajo la curva <span class="math inline">\(f(x)=1/360\)</span> que se calcula integrando sobre el intervalo de interés</li>
</ul>
<p>Para generalizar la idea es la siguiente:</p>
<ul>
<li>Usamos la fórmula anterior, pero modificamos o perturbamos la función <span class="math inline">\(f(x) = 1/360\)</span> para que <span class="math inline">\(f\)</span> sea un poco más alta alrededor de 270 grados (abajo), y un poco más baja alrededor de 90 grados (arriba).</li>
<li>Lo único que necesitamos es que <span class="math inline">\(f(x)\)</span> no puede tomar valores negativos (por que si no obtendríamos probabilidades negativas en algunos sectores), y la integral sobre la ruleta completa debe ser uno:</li>
</ul>
<p><span class="math display">\[P(X\in [0, 360]) = \int_0^{360} f(x)\,dx = 1\]</span></p>
<p>Podríamos utilizar por ejemplo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>f_dens <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    x_rad <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x <span class="sc">/</span> <span class="dv">360</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span><span class="sc">/</span><span class="dv">360</span>) <span class="sc">+</span>  <span class="fl">0.0002</span> <span class="sc">*</span> <span class="fu">cos</span>(x_rad <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> pi  <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>graf_1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">angulo =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dv">1</span>), <span class="at">tipo =</span> <span class="st">"uniforme"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">f =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">360</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>graf_2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">angulo =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dv">1</span>), <span class="at">tipo =</span> <span class="st">"colgada"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">f_dens</span>(angulo))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>graf_tbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(graf_1_tbl, graf_2_tbl)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(graf_tbl, <span class="fu">aes</span>(<span class="at">x =</span> angulo, <span class="at">y =</span> f, <span class="at">colour =</span> tipo)) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.003</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>tipo, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>El cálculo se hace ahora con área bajo la curva. Para calcular la probabilidad</p>
<p><span class="math display">\[P(X\in [50, 130]),\]</span></p>
<p>integramos la función <span class="math inline">\(f\)</span> correspondiente, que corresponde a calcular área bajo la curva:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(graf_tbl, <span class="fu">aes</span>(<span class="at">x =</span> angulo, <span class="at">y =</span> f, <span class="at">colour =</span> tipo)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.003</span>)) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>tipo, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(angulo <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> angulo <span class="sc">&lt;</span> <span class="dv">130</span>, angulo, <span class="dv">0</span>)), </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Y ahora vemos que para la versión perturbada, más de la probabilidad se concentra alrededor de 270 grados que alrededor de 90. Por las propiedades de la integral, todas las propiedades usuales de probabilidad se cumplen.</p>
</section>
</div></section>
<section id="funciones-de-densidad" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="funciones-de-densidad"><span class="header-section-number">10.2</span> Funciones de densidad</h2>
<p>Cuando trabajamos con mediciones de tipo continuo, es más conveniente definir asignaciones de probabilidad utilizando <em>funciones de densidad de probabilidad</em>:</p>
<div class="cell" type="comentario">

<div class="comentario">
<p>Una función <span class="math inline">\(f(x)\)</span> no negativa cuya integral es igual a 1 es una función de densidad de probabilidad. Las probabilidades asociadas se calculan integrando:</p>
<p><span class="math display">\[P(X\in [a,b]) = \int_a^b f(x)\,dx\]</span></p>
En este caso decimos que <span class="math inline">\(f\)</span> es la función de densidad de probabilidad asociada a la variable aleatoria <span class="math inline">\(X\)</span>. A este tipo de variables aleatorias les llamamos <em>continuas</em>.
</div>
</div>
</section>
<section id="ejemplo-densidad-triangular" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="ejemplo-densidad-triangular"><span class="header-section-number">10.3</span> Ejemplo: densidad triangular</h2>
<p>Supongamos que tenemos una variable aleatoria que tiene mediana 2, y puede tomar valores entre 0 y 4. Podríamos definir una densidad como sigue: Si <span class="math inline">\(x\)</span> está entre 0 y 2, entonces</p>
<p><span class="math display">\[f(x) = \frac{x}{4}\]</span></p>
<p>y si <span class="math inline">\(x\)</span> está entre 2 y 4, entonces</p>
<p><span class="math display">\[f(x) = 1 - \frac{x}{4}\]</span></p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dens_triangular <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">4</span>) <span class="sc">*</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">2</span>, x<span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span> <span class="sc">-</span> x<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>triangular_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dens_triangular</span>(x)) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(triangular_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<section id="ejemplo" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo">Ejemplo</h3>
<p>Supongamos que una variable <span class="math inline">\(X\)</span> tiene mediana 2 y rango de 0 a 4, con densidad triangular. ¿Cuál es la probabilidad <span class="math inline">\(P(X&gt;1)\)</span>?</p>
<p>Solución: Por reglas usuales de probabilidad, <span class="math inline">\(P(X&gt;1) = P(1&lt;X&lt;2) + P(X\geq2)\)</span>. Tenemos que <span class="math inline">\(P(X\geq 2) = 0.5\)</span>. Ahora usamos la fórmula de la densidad triangular para obtener</p>
<p><span class="math display">\[P(1&lt;X&lt;2) = \int_{1}^{2} f(x)\,dx = \int_1^2 \frac{x}{4}\,dx =
\left [\frac{x^2}{8}\right ]_1^2 = 1/2 - 1/8 = 3/8 = 0.375\]</span></p>
<p>de modo que</p>
<p><span class="math display">\[P(X&lt;1) = 0.375 +0.500 = 0.875\]</span></p>
<p>En general, podemos dar una fórmula para una densidad triangular en el intervalo <span class="math inline">\([A,B]\)</span> con mediana en <span class="math inline">\((A + B)/2\)</span>. ¿Cómo sería la fórmula?</p>
</section>
</section>
<section id="cuantiles-de-variables-aleatorias" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="cuantiles-de-variables-aleatorias"><span class="header-section-number">10.4</span> Cuantiles de variables aleatorias</h2>
<p>Antes vimos la definición de cuantiles para datos numéricos. Podemos definirlos también para variables aleatorias numéricas:</p>
::: {.cell type=‘comentario’}
<div class="comentario">
<p>Sea <span class="math inline">\(p\in (0,1)\)</span>. El cuantil-<span class="math inline">\(p\)</span> de la variable <span class="math inline">\(X\)</span> con función de densidad <span class="math inline">\(f(x)\)</span> es el valor <span class="math inline">\(x(p)\)</span> tal que</p>
<p><span class="math display">\[\int_{-\infty}^{x(p)} f(x)\,dx = p\]</span></p>
<pre><code>&lt;/div&gt;\EndKnitrBlock{comentario}</code></pre>
<p>:::</p>
<p>Observación: nótese que usamos como límite inferior <span class="math inline">\(-\infty\)</span> para indicar que integramos <span class="math inline">\(f\)</span> sobre toda la densidad que esté a la izquierda de <span class="math inline">\(x(p)\)</span>.</p>
<section id="ejemplo-densidad-triangular-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejemplo-densidad-triangular-1">Ejemplo: densidad triangular</h3>
<p>Supongamos que <span class="math inline">\(X\)</span> tiene la densidad triangular mostrada arriba. Calcula el cuartil inferior y superior (es decir, los cuantiles 0.25 y 0.75). Para el cuartil superior, por ejemplo, buscamos al <span class="math inline">\(x(0.75)\)</span> de la siguiente gráfica:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"R/triangular.R"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(triangular_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="fu">qtri</span>(<span class="fl">0.75</span>, <span class="dv">0</span>, <span class="dv">4</span>), x, <span class="dv">0</span>)), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">qtri</span>(<span class="fl">0.75</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="fl">0.03</span>, <span class="at">label =</span> <span class="st">"x(0.75)"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="fu">qtri</span>(<span class="fl">0.75</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="fl">0.0</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comenzaremos por el cuartil inferior. Buscamos una <span class="math inline">\(x(0.25)\)</span> tal que</p>
<p><span class="math display">\[\int_0^{x(0.25)} f(x)\,dx = 0.25\]</span></p>
<p>Sabemos que <span class="math inline">\(x(0.25)&lt; 2\)</span>, pues la integral hasta 2 es 0.5, así que</p>
<p><span class="math display">\[\int_0^{x(0.25)} f(x)\,dx = \int_0^{x(0.25)} x/4 \,dx = \left [ x^2/8\right]_0^{x(0.25)} = (x(0.25))^2/8\]</span></p>
<p>Si queremos que este valor sea igual a 0.25, entonces despejando obtenemos</p>
<p><span class="math display">\[x(0.25) = \sqrt{0.25(8)} = \sqrt{2}\approx 1.4142\]</span></p>
<p>Ahora podríamos calcular la otra integral, pero por simetría podemos concluir que</p>
<p><span class="math display">\[x(0.75) = 2 + (2 - 1.4142) \approx 2.5858\]</span></p>
<p>y concluimos que los cuartiles inferiores y superiores son aproximadamente 1.41 y 2.59</p>
</section>
<section id="ejercicio-densidad-uniforme" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejercicio-densidad-uniforme">Ejercicio: densidad uniforme</h3>
<p>Calcula la mediana, y los percentiles 0.10 y 0.90 de una variable uniforme en <span class="math inline">\([0, 10]\)</span>.</p>
</section>
</div></section>
<section id="comparando-cuantiles-teóricos-y-empíricos" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="comparando-cuantiles-teóricos-y-empíricos"><span class="header-section-number">10.5</span> Comparando cuantiles teóricos y empíricos</h2>
<p>Los cuantiles que vimos en la parte de descriptivos para datos numéricos se llaman usualmente <em>cuantiles empíricos</em>. Estos cuantiles podemos compararlos con cuantiles teóricos para ver qué tan similares son, y si el modelo teórico describe adecuadamente los datos.</p>
<section id="ejemplo-distribución-uniforme" class="level3" data-number="10.5.1">
<h3 data-number="10.5.1" class="anchored" data-anchor-id="ejemplo-distribución-uniforme"><span class="header-section-number">10.5.1</span> Ejemplo: distribución uniforme</h3>
<p>Simularemos 500 datos uniformes en <span class="math inline">\([0, 10]\)</span>:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x_sim_u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Podríamos calcular algunos cuantiles empíricos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(x_sim_u, <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.50</span>, <span class="fl">0.90</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      10%       50%       90% 
0.8740116 4.7480174 8.7635375 </code></pre>
</div>
</div>
<p>Por el ejercicio anterior sabemos cuáles son los cuantiles teóricos correspondientes a una uniforme en <span class="math inline">\([0,10]\)</span>. Podemos calcularlos también como sigue:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qunif</span>(<span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.5</span>, <span class="fl">0.90</span>), <span class="dv">0</span>, <span class="dv">10</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 5 9</code></pre>
</div>
</div>
<p>Y vemos que son muy similares los cuantiles empíricos y teóricos. Una mejor manera de considerar esta similitud es graficando <em>todos</em> los cuantiles empíricos y comparándolos con los teóricos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> x_sim_u), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qunif, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Cuantiles Teóricos U(0,10)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Cuantiles de datos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y vemos que la forma de las dos distribuciones es muy similar: los cuantiles empíricos son muy similares a los teóricos. Existen algunas fluctuaciones debidas al muestreo aleatorio.</p>
</section>
<section id="ejemplo-distribución-triangular" class="level3" data-number="10.5.2">
<h3 data-number="10.5.2" class="anchored" data-anchor-id="ejemplo-distribución-triangular"><span class="header-section-number">10.5.2</span> Ejemplo: distribución triangular</h3>
<p>Repetimos para la distribución triangular. Los cuantiles que calculamos arriba son:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtri</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.414214 2.585786</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x_sim_tri <span class="ot">&lt;-</span> <span class="fu">rtri</span>(<span class="dv">500</span>, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> x_sim_tri), <span class="fu">aes</span>(<span class="at">sample =</span> x)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> qtri, <span class="at">dparams =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Cuantiles Teóricos triangular(0,4)"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Cuantiles de datos"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nótese que otra vez, los cuantiles teóricos se alinean bien con los teóricos.</p>
</section>
</section>
<section id="histogramas-y-densidades" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="histogramas-y-densidades"><span class="header-section-number">10.6</span> Histogramas y densidades</h2>
<p>Para el análisis de datos usual, las gráficas cuantil-cuantil tienden a ser útiles para entender si unos datos se comportan según alguna densidad teórica. Sin embargo, muchas veces se usan histogramas, como en las siguientes gráficas:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>hist_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> x_sim_u),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">boundary =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dunif</span>(x, <span class="dv">0</span>, <span class="dv">10</span>)),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f), <span class="at">colour =</span> <span class="st">"red"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>hist_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> x_sim_tri),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">boundary =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dtri</span>(x, <span class="dv">0</span>, <span class="dv">4</span>)),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f), <span class="at">colour =</span> <span class="st">"red"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>hist_1 <span class="sc">+</span> hist_2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nótese la escala vertical de estos histogramas, que no es simplemente el conteo de casos que caen en cada intervalo del histograma. Para poder comparar los conteos con las densidades correspondientes, es necesario observar lo siguiente:</p>
<p>Si <span class="math inline">\(I = [a,b]\)</span> es un intervalo del histograma, según la densidad (teórica), la probabilidad de que un dato <span class="math inline">\(x\)</span> caiga en <span class="math inline">\(I\)</span> es</p>
<p><span class="math display">\[P(x\in I) = \int_{a}^b f(x)\,dx \approx f(a) (b-a)\]</span></p>
<p>La última aproximación se debe a que en un intervalo chico <span class="math inline">\([a,b]\)</span>, el área bajo la curva de <span class="math inline">\(f(x)\)</span> es aproximadamente igual a la base (el ancho del intervalo) por la altura en un punto de la curva (<span class="math inline">\(f(a)\)</span>, aunque también podríamos usar <span class="math inline">\(f(\frac{a+b}{2})\)</span> por ejemplo).</p>
<p>Si tenemos <span class="math inline">\(n\)</span> observaciones, esperamos entonces que caigan <span class="math inline">\(nP(X\in I)\)</span> en el intervalo <span class="math inline">\(I\)</span>, de forma que si <span class="math inline">\(n([a,b])\)</span> es el número de observaciones que caen en <span class="math inline">\(I = [a,b]\)</span>, esperamos</p>
<p><span class="math display">\[\frac{n([a,b])}{n} \approx f(a)(b-a),\]</span></p>
<p>y despejando obtenemos</p>
<p><span class="math display">\[f(a)\approx \frac{n([a, b])}{n(b-a)}.\]</span></p>
<p>Esto implica que para aproximar la densidad, es necesario dividir las frecuencias relativas entre el ancho de los intervalos correspondientes, y de ahí la escala vertical de las gráficas de arriba.</p>
<p><strong>Observación</strong>: las gráficas de cuantiles son generalmente más prácticas para evaluar el ajuste a un modelo teórico, aunque son menos comunes.</p>
</section>
<section id="más-descriptivos-media-y-desviación-estándar" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="más-descriptivos-media-y-desviación-estándar"><span class="header-section-number">10.7</span> Más descriptivos: media y desviación estándar</h2>
<p>Podemos utilizar cuantiles para describir modelos teóricos y también conjuntos de datos (por ejemplo, mediana para centralidad y diferencia entre cuantiles 0.9 y 0.10 para dispersión), y funcionan bien en general. Sin embargo, para modelos teóricos y conjuntos de datos particulares muchas veces es más conveniente usar medidas como la media y desviación estándar.</p>
<section id="media-teórica-y-empírica" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="media-teórica-y-empírica"><span class="header-section-number">10.7.1</span> Media teórica y empírica</h3>
<p>Sabemos que la media de un conjunto de datos <span class="math inline">\(x_1,x_2,\ldots,x_n\)</span> está dada por</p>
<p><span class="math display">\[\bar{x} = \frac{x_1 + x_2 + \cdots x_n}{n}.\]</span></p>
<p>Ahora consideremos qué pasa con esta cantidad cuando las <span class="math inline">\(x_i's\)</span> son observaciones independientes de una distribución con densidad teórica <span class="math inline">\(f(x)\)</span>. Utilizaremos simulaciones de la distribución triangular que vimos arriba</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rtri</span>(<span class="dv">5000</span>, <span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> <span class="fu">stat_bin</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.25</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Podemos aproximar la media de estos datos promediando los valores iniciales de los intervalos de corte ponderado por el número de casos. Lo hacemos así:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>particion <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.25</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>iniciales <span class="ot">&lt;-</span> <span class="fu">head</span>(particion, <span class="sc">-</span><span class="dv">1</span>) <span class="co"># quitar último</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>agrupados_cubeta <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inicial =</span> <span class="fu">cut</span>(x, <span class="at">breaks =</span> particion, <span class="at">labels =</span> iniciales)) <span class="sc">%&gt;%</span>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inicial =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(inicial))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(inicial) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>agrupados_cubeta</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   inicial     n
     &lt;dbl&gt; &lt;int&gt;
 1    0       40
 2    0.25   121
 3    0.5    212
 4    0.75   273
 5    1      360
 6    1.25   439
 7    1.5    488
 8    1.75   575
 9    2      558
10    2.25   507
11    2.5    439
12    2.75   354
13    3      269
14    3.25   210
15    3.5    122
16    3.75    33</code></pre>
</div>
</div>
<p>Y calculamos la aproximación a la media como sigue:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>agrupados_cubeta <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_aprox =</span> <span class="fu">sum</span>(inicial <span class="sc">*</span> n) <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  media_aprox
        &lt;dbl&gt;
1        1.87</code></pre>
</div>
</div>
<p>Apliquemos esta idea cuando tenemos una densidad <span class="math inline">\(f(x)\)</span>. Dividimos el rango de la densidad en cubetas, y aproximamos la densidad por rangos, por ejemplo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>particion <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.25</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>valor <span class="ot">&lt;-</span> <span class="fu">dtri</span>(particion, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>approx_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> particion, <span class="at">densidad =</span> valor)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>densidad_tri <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">densidad =</span> <span class="fu">dtri</span>(x, <span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(densidad_tri) <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">'f(x)'</span>) <span class="sc">+</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y=</span> densidad), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">data =</span> approx_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> densidad), <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y repetimos el mismo proceso: ponderamos los valores iniciales por la altura de la densidad:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>approx_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_approx =</span> <span class="fu">sum</span>(x <span class="sc">*</span> densidad) <span class="sc">/</span> <span class="fu">sum</span>(densidad))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  media_approx
         &lt;dbl&gt;
1            2</code></pre>
</div>
</div>
<p>Y esta es una aproximación a la media de esta distribución.</p>
<p>Nótese que la cantidad que estamos calculando es</p>
<p><span class="math display">\[\sum_i x_i f(x_i) \Delta\]</span></p>
<p>donde <span class="math inline">\(\Delta\)</span> es igual a</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>approx_tbl <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">suma_densidad =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sum</span>(densidad))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  suma_densidad
          &lt;dbl&gt;
1          0.25</code></pre>
</div>
</div>
<p>que es el ancho del intervalo de las particiones. Recordamos por cálculo que esta es una la aproximación a la siguiente integral:</p>
<p><span class="math display">\[\sum_i x_i f(x_i) \Delta \approx  \int xf(x)\,dx\]</span></p>
<p>De modo que para pasar de media de los datos <span class="math inline">\(\bar{x}\)</span> a la media de <span class="math inline">\(\mu_f\)</span> de una distribución la equivalencia es:</p>
<p>$$</p>
<p>{x} = x_i xf(x) = </p>
<p>$$ donde</p>
<ul>
<li>Usamos la densidad en lugar de frecuencias relativas para ponderar</li>
<li>Usamos integral en lugar de suma</li>
</ul>
<p>Es decir, cuando tenemos una densidad teórica continua, es necesario <strong>integrar</strong> en lugar de <strong>sumar</strong> para calcular su media.</p>
</section>
<section id="varianza-y-desviación-estándar" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="varianza-y-desviación-estándar"><span class="header-section-number">10.7.2</span> Varianza y desviación estándar</h3>
<p>Otra cantidad importante es la varianza de una muestra. Es una medida de dispersión, y se calcula como</p>
<p>$$</p>
<p>^2 = _{i=1}^n (x_i - {x})^2</p>
<p>$$</p>
<p>Nótese que cuando los datos están altamente concentrados alrededor del valor de la media, la varianza es chica, y cuando hay más dispersión alrededor de la media, la varianza es grande.</p>
<p>La <strong>desviación estándar</strong> es la raíz cuadrada de esta cantidad:</p>
<p>$$</p>
<p> = </p>
<p>$$ que tiene la ventaja de que está en las mismas unidades que la variable original.</p>
<p>Siguiendo el mismo patrón que arriba, tenemos que integrar en lugar de sumar, y ponderar por la densidad en lugar de la frecuencia: El equivalente en una distribución teórica es también una integral, y la varianza está definida por</p>
<p><span class="math display">\[\sigma^2 = \int (x - \mu)^2 f(x) \,dx\]</span></p>
<p>La desviación estándar <span class="math inline">\(\sigma\)</span> es la raíz cuadrada de esta cantidad.</p>
<p><span class="math display">\[\sigma = \sqrt{\int (x - \mu)^2 f(x)\,dx}\]</span></p>
<p>En resumen la densidad indica la frecuencia relativa de datos que esperamos observar alrededor de cada punto, y</p>
<ul>
<li>Resúmenes de una distribución teórica (como cuantiles, media, varianza, etc.) se calculan integrando ponderado por la densidad.</li>
<li>Resúmenes de una distribución empírica se calculan sumando ponderando por la frecuencia relativa.</li>
</ul>
</section>
<section id="notación" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="notación">Notación</h3>
<p>Para la media de una variable aleatoria <span class="math inline">\(X\)</span> con densidad <span class="math inline">\(f\)</span>, utilizamos la notación siguiente:</p>
<p><span class="math display">\[\mu = \int x f(x)\,dx = E(X)\]</span></p>
<p>y decimos también que <span class="math inline">\(E(X)\)</span> es el valor esperado de <span class="math inline">\(X\)</span>. Igualmente, la varianza podemos escribirla como el valor esperado de la variable <span class="math inline">\((X-\mu)^2\)</span>:</p>
<p><span class="math display">\[\sigma^2 = \int (x - \mu)^2 f(x)  = E\left ( (X-\mu)^2 \right)\]</span></p>
<p>Aunque esto requiere de un teorema simple (el teorema del estadístico inconsciente) que establece que para cualquier función <span class="math inline">\(h\)</span>, si <span class="math inline">\(Y=h(X)\)</span> y <span class="math inline">\(f\)</span> es la función de densidad de <span class="math inline">\(X\)</span>, entonces</p>
<p><span class="math display">\[E(Y) = E(h(X)) = \int h(x) f(x) \,dx\]</span></p>
</section>
<section id="cuándo-usar-media-y-desviación-estándar" class="level3" data-number="10.7.3">
<h3 data-number="10.7.3" class="anchored" data-anchor-id="cuándo-usar-media-y-desviación-estándar"><span class="header-section-number">10.7.3</span> ¿Cuándo usar media y desviación estándar?</h3>
<p>Algunos modelos probabilísticos son más fáciles de tratar analíticamente usando media y varianza. En esos casos, conviene usar estas medidas. Esto es especialmente cierto cuando las distribuciones son simétricas y no tienen colas muy largas.</p>
<p>En cuanto a datos observados, conviene usar media y varianza cuando pretendemos modelarlos con densidades como las del párrafo anterior. En este caso, la interpretación de estos valores se hace a través de la forma de la densidad. Es importante checar (por ejemplo usando gráficas de cuantiles) que esas densidades describen apropiadamente a los datos.</p>
</section>
<section id="ejercicio" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="ejercicio">Ejercicio</h3>
<ul>
<li>Calcula media y desviación estándar para una densidad triangular (0,4) y otra (0,10)</li>
<li>Calcula media y desviación estándar para una densidad uniforme en (0,4) y otra uniforme en (0, 10)</li>
<li>Contrasta tus resultados. ¿Las medias ocurren en el lugar que esperabas? ¿Qué distribuciones presentan más dispersión de acuerdo a la desviacion estándar?</li>
</ul>
</section>
</section>
<section id="la-distribución-normal" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="la-distribución-normal"><span class="header-section-number">10.8</span> La distribución normal</h2>
<p>La distribución normal es una que aparece naturalmente en al teoría de probabilidad.</p>
<section id="promedio-de-variables" class="level3" data-number="10.8.1">
<h3 data-number="10.8.1" class="anchored" data-anchor-id="promedio-de-variables"><span class="header-section-number">10.8.1</span> Promedio de variables</h3>
<p>Consideremos que tiramos 40 dados justos de 6 lados, y consideramos su promedio <span class="math inline">\(\bar{X}\)</span> como resultado de nuestro experimento aleatorio. ¿Cómo se ve la distribución de probabilidades de esta variable <span class="math inline">\(\bar{X}\)</span>?</p>
<p>Comenzamos haciendo simulacion:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>simular_bolsa <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">num_dados =</span> <span class="dv">40</span>){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    dados <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num_dados, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    media <span class="ot">&lt;-</span> <span class="fu">mean</span>(dados)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    media</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">simular_bolsa</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.075</code></pre>
</div>
</div>
<p>Veamos cómo se ven los resultados si hacemos este experimento un número grande de veces:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>sims_dados <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="sc">~</span> <span class="fu">simular_bolsa</span>())</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_dados), </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> resultado)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Y notamos una forma de “campana” interesante. Esto se explica porque típicamente tendremos tiros bajos y altos, de modo que muchos resultados de este experimento se concentran alrededor de la media de un dado (3.5). Además, existen fluctuaciones aleatorios, y a veces tenemos un poco más de tiros altos o de tiros bajos, de forma que existe dispersión alrededor de 3.5.</p>
<p>Sin embargo, estas desviaciones de 3.5 no pueden ser muy grandes: por ejemplo, para tener un promedio de 1, todas las tiradas de los 40 dados tendrían que dar 1, y eso es muy poco probable. Igualmente, para que el promedio fuera cercano a 6, la gran mayoría de los 40 dados deberían de dar 6, lo cual otra vez es muy poco probable. Esto explica al menos la forma general de la forma de las colas derecha e izquierda de esta distribución.</p>
<p>Los dados podrían ser diferentes (por ejemplo, un poco cargados a 1 o 6, o más cargados a valores centrales), y los argumentos de arriba también se cumplirían. Lo que <strong>es sorprendente</strong> es que, independientemente de cómo sean las particularidades de los dados, la forma analítica de esta distribución que acabamos de mostrar <strong>es la misma</strong>.</p>
<p>Esta forma está descrita por la densidad normal estándar:</p>
<p><span class="math display">\[f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\]</span></p>
<p>cuya gráfica presentamos a continuación:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>A una variable <span class="math inline">\(Z\)</span> que tiene esta densidad le llamamos una variable con <strong>distribución normal estándar</strong>. Comparemos cuantiles en nuestro ejemplo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_dados),</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> resultado)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Normal estándar teórica"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Promedio de 40 dados"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Y notamos que los cuantiles no corresponden, pero el espaciamiento entre los cuantiles de los datos y los teóricos de la normal estándar es el mismo. Quiere decir que estas dos distribuciones <strong>tienen la misma forma</strong>, aunque estén escaladas y centradas en distintos valores.</p>
<p>Probemos con promedios de 20 observaciones triangulares en <span class="math inline">\((0,1)\)</span> por ejemplo. El resultado es el mismo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sims_tri <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, <span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">rtri</span>(<span class="dv">20</span>, <span class="dv">0</span> ,<span class="dv">1</span>)))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_tri), </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> resultado)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">resultado =</span> sims_tri),</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">sample =</span> resultado)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">distribution =</span> stats<span class="sc">::</span>qnorm) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Normal estándar teórica"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Promedio de 20 triangulares (0,1)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Otra vez, la forma general es la misma, aún cuando los datos están centrados y escalados de manera distinta.</p>
</section>
</section>
<section id="la-densidad-normal-estándar" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="la-densidad-normal-estándar"><span class="header-section-number">10.9</span> La densidad normal estándar</h2>
<p>Como expicamos, la densidad normal estándar está dada por</p>
<p><span class="math display">\[f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}},\]</span></p>
<p>cuya gráfica es como sigue:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>normal_std_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_std_graf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Las probabilidades asociadas a una normal estándar se calculan integrando esta curva (que tiene que hacerse de forma numérica). Por ejemplo, para calcular</p>
<p><span class="math display">\[P(Z &lt; 1.5),\]</span></p>
<p>podemos usar</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9331928</code></pre>
</div>
</div>
<p>Que es el área bajo la curva mostrada abajo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>normal_std_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.005</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_std_graf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="sc">-</span><span class="fl">3.5</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="fl">1.5</span>, x, <span class="dv">0</span>)), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">0.5</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Esta es la forma de la densidad estándar. Podemos centrar esta campana en otro valor <span class="math inline">\(\mu\)</span> y aumentar la dispersión por un factor <span class="math inline">\(\sigma\)</span>. Si <span class="math inline">\(Z\)</span> es una variable normal estándar, la variable</p>
<p><span class="math display">\[X = \mu + \sigma Z\]</span></p>
<p>es una variable <strong>normal</strong> con parámetros <span class="math inline">\((\mu, \sigma)\)</span>, o de manera más compacta, decimos que <span class="math inline">\(X\)</span> es <span class="math inline">\(N(\mu, \sigma)\)</span>. La distribución normal estándar es <span class="math inline">\(N(0,1)\)</span>.</p>
<p>Por ejemplo, si escogemos <span class="math inline">\(\mu=5\)</span> y <span class="math inline">\(\sigma = 0.5\)</span>, obtenemos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>normal_graf <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="dv">5</span>, <span class="fl">0.5</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(normal_graf, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f)) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Podemos mostrar juntas estas dos distribuciones:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>densidad_normal <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">densidad =</span> <span class="fu">dnorm</span>(x, <span class="dv">5</span>, <span class="fl">0.5</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>densidad_normal_estandar <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">densidad =</span> <span class="fu">dnorm</span>(x))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>g_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(densidad_normal_estandar, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> densidad)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>g_3 <span class="ot">&lt;-</span> g_2 <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>g_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(densidad_normal, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> densidad)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">7</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>g_3 <span class="sc">+</span> g_1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede demostrar que:</p>
<div class="cell" type="comentario">

<div class="comentario">
<p><strong>Distribución normal</strong></p>
<ul>
<li>La distribución normal estándar <span class="math inline">\(N(0,1)\)</span> tiene media 0 y desviación estándar 1</li>
<li>La distribución normal <span class="math inline">\(N(\mu,\sigma)\)</span> tiene media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma\)</span></li>
</ul>
</div>
</div>
</section>
<section id="cuantiles-y-concentración-de-la-densidad-normal" class="level2" data-number="10.10">
<h2 data-number="10.10" class="anchored" data-anchor-id="cuantiles-y-concentración-de-la-densidad-normal"><span class="header-section-number">10.10</span> Cuantiles y concentración de la densidad normal</h2>
<p>Con un poco de cálculo podemos ver qué tan fuertemente se concentra la densidad alrededor de la media para una distribución normal. La regla es la siguiente:</p>
<ul>
<li>68% de la densidad se concentra en el intervalo <span class="math inline">\([\mu-\sigma, \mu+\sigma]\)</span></li>
<li>95% de la densidad se concentra en el intervalo <span class="math inline">\([\mu-2\sigma, \mu+2\sigma]\)</span></li>
<li>99.7% de la densidad se concentra en el intervalo <span class="math inline">\([\mu-3\sigma, \mu+3\sigma]\)</span></li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>grafica_concentracion <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, z){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(mu <span class="sc">-</span> <span class="fl">3.1</span> <span class="sc">*</span> sigma, mu <span class="sc">+</span> <span class="fl">3.1</span> <span class="sc">*</span> sigma, <span class="fl">0.01</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  valor <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu, sigma)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> x, <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span><span class="ot">=</span>valor)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>(<span class="fu">pnorm</span>(z) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span>z)), <span class="dv">1</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  texto <span class="ot">&lt;-</span> <span class="fu">paste0</span>(texto, <span class="st">"%"</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="st">`</span><span class="at">f(x)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">filter</span>(datos, x <span class="sc">&lt;</span> mu <span class="sc">+</span> z<span class="sc">*</span>sigma, x <span class="sc">&gt;</span> mu <span class="sc">-</span> z<span class="sc">*</span>sigma), </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="st">"salmon"</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mu, <span class="at">y =</span> <span class="fl">0.1</span>, <span class="at">label =</span> texto) <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> mu <span class="sc">+</span> sigma<span class="sc">*</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>) </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>g_68 <span class="ot">&lt;-</span> <span class="fu">grafica_concentracion</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>g_95 <span class="ot">&lt;-</span> <span class="fu">grafica_concentracion</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>g_997 <span class="ot">&lt;-</span> <span class="fu">grafica_concentracion</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>paneles <span class="ot">&lt;-</span> g_68 <span class="sc">+</span> g_95 <span class="sc">+</span> g_997</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>paneles <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Concentración alrededor de la media (normal)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p><strong>Nota</strong>: esto aplica para cualquier densidad normal, independientemente de los parámetros.</p>
<p>Obsérvese que esto nos da una interpretación natural de la desviación estándar de una distribución normal en términos de percentiles de los datos, y la manera usual con la que entendemos la desviación estándar de la distribución normal.</p>
</section>
<section id="el-teorema-central-del-límite" class="level2" data-number="10.11">
<h2 data-number="10.11" class="anchored" data-anchor-id="el-teorema-central-del-límite"><span class="header-section-number">10.11</span> El teorema central del límite</h2>
<p>Una de las razones por las que el modelo normal es tan importante es el siguiente resultado:</p>
::: {.cell type=‘comentario’}
<div class="comentario">
<p><strong>Teorema central del límite</strong></p>
<p>Si <span class="math inline">\(X_1,X_2,\ldots, X_n\)</span> son variables aleatorias independientes con media <span class="math inline">\(\mu\)</span> y desviación estándar <span class="math inline">\(\sigma\)</span> con una densidad <span class="math inline">\(f(x)\)</span>:</p>
<ul>
<li><p><span class="math inline">\(S_n = X_1 + X_2 + \cdots X_n\)</span> es aproximadamente normal cuando <span class="math inline">\(n\)</span> es suficientemente grande</p>
</li></ul></div>
<p>:::</p>
<li><p>Muchas cantidades de interés en la estadística se pueden definir como sumas o promedios de un número grande de variables aleatorias (por ejempo, cuando queremos estimar el total de ingreso de los hogares, estatura promedio en una población, etc.) Los percentiles de una muestra grande también cumplen un teorema central del límite de este tipo.</p></li>
<li><p>La aproximación del teorema central del límite mejora cuando <span class="math inline">\(n\)</span> es más grande. Aunque una regla de dedo dice que <span class="math inline">\(n\geq 30\)</span> es suficiente para muchas distribuciones, puede ser que sea necesaria usar una <span class="math inline">\(n\)</span> más grande.</p></li>

<p>Esto nos permite, por ejemplo, considerar nuestro primera técnica de estimación por intervalos:</p>
<ul>
<li>Observamos una muestra grande <span class="math inline">\(x_1,\ldots, x_n\)</span> de datos de una población (no necesariamente con distribución normal). Supongamos que buscamos estimar la media <span class="math inline">\(\mu\)</span> de la población con un intervalo.</li>
<li>Estimamos la media con</li>
</ul>
<p><span class="math display">\[\bar{x} = \frac{1}{n}(x_1+\cdots + x_n) = \frac{1}{n}\sum_i x_i,\]</span></p>
<ul>
<li>Por el teorema del límite central, {x} es aproximadamente normal, y su media es <span class="math inline">\(\mu\)</span>. Esto implica que</li>
</ul>
<p><span class="math display">\[P(\mu - 2\sigma  \leq \bar{x} \leq\mu + 2\sigma)\approx 0.95\]</span></p>
<p>Despejando <span class="math inline">\(\mu\)</span> obtenemos</p>
<p><span class="math display">\[P(\bar{x} - 2\sigma  \leq \mu  \leq\bar{x} + 2\sigma)\approx 0.95\]</span></p>
<p>Finalmente, no conocemos <span class="math inline">\(\sigma\)</span>, pero la estimamos con</p>
<p><span class="math display">\[\hat{\sigma}^2 = \frac{1}{n}((x_1 - \bar{x})^2 + \dots + (x_n - \bar{x})^2) = \frac{1}{n}\sum_i(x_i - \bar{x})^2\]</span></p>
<p>Y aproximamos sustituyendo nuestra estimación:</p>
<p><span class="math display">\[P(\bar{x} - 2\hat{\sigma } \leq \mu  \leq\bar{x} + 2\hat{\sigma})\approx 0.95\]</span></p>
<p>Esto nos da un intervalo (llamado el <strong>intervalo de Wald</strong>) con 95% de confianza para la media poblacional:</p>
<p><span class="math display">\[[\bar{x} - 2\hat{\sigma }  , \bar{x} + 2\hat{\sigma}]\]</span></p>
<p>Notas:</p>
<ul>
<li>Por otras razones técnicas, a veces se usa <span class="math inline">\(s^2 = \frac{1}{n-1}\sum_i (x_i-\bar{x})^2\)</span> en lugar de <span class="math inline">\(\hat{\sigma}^2\)</span>. Si la muestra es grande esto no es importante.</li>
<li>Estos intervalos tienen cobertura <em>nominal</em> de 95%, sin embargo, puede variar dependiendo del tamaño de muestra y la forma de la distribución teórica (poblacional). Existen métodos como el <em>bootstrap</em> donde podemos checar qué tan razonable es hacer esta aproximación. También se puede hacer simulación modelando la distribución <span class="math inline">\(f(x)\)</span>.</li>
</ul>
</section>
<section id="otras-densidades-comunes" class="level2" data-number="10.12">
<h2 data-number="10.12" class="anchored" data-anchor-id="otras-densidades-comunes"><span class="header-section-number">10.12</span> Otras densidades comunes</h2>
<p>Como vimos arriba, consideraciones teóricas hacen razonable suponer que una variable aleatoria tiene cierta distribución: por ejemplo, si una variable aleatoria es suma de muchas perturbaciones independientes, la suma o promedio resultante puede modelarse como una distribución normal.</p>
<p>Otras consideraciones teóricas sugieren otro tipo formas útiles de densidades. Un primer ejemplo es la distribución exponencial.</p>
<section id="variables-aleatorias-exponenciales" class="level3" data-number="10.12.1">
<h3 data-number="10.12.1" class="anchored" data-anchor-id="variables-aleatorias-exponenciales"><span class="header-section-number">10.12.1</span> Variables aleatorias exponenciales</h3>
<p>Supongamos que estamos modelando tiempos a la ocurrencia <span class="math inline">\(X\)</span> de un evento (por ejemplo en análisis de supervivencia en estudios clínicos). Esta es una variable que toma valores en los números positivos. ¿Cómo podría ser su forma?</p>
<p>Consideremos por ejemplo que el tiempo de espera <em>no tienen memoria</em>. Es decir: si hay esperamos un periodo de <span class="math inline">\(t\)</span> días por ejemplo, la distribución del tiempo restante que tenemos que esperar no depende de <span class="math inline">\(s\)</span>. En términos de probabilidad, podríamos escribir:</p>
<p><span class="math display">\[P(X &gt; s + t | X &gt; t) = P(X &gt; s)\]</span></p>
<p>Esto se lee: dado que el evento ocurre en más de <span class="math inline">\(t\)</span> días, la probabilidad de que tarde al menos otros <span class="math inline">\(s\)</span> días no dependen de <span class="math inline">\(t\)</span>. A la función <span class="math inline">\(S(t) = P(X&gt;t)\)</span> muchas veces se le llama la <strong>función de supervivencia</strong>.</p>
<p>Este es un modelo base útil, que después puede extenderse a procesos donde los eventos ocurren aceleradamente (envejecen), o donde los eventos dan evidencia de robustez (los que han sobrevivido hasta cierto tiempo se espera que duren más que lo que inicialmente), o quizá una combinación de los dos dependiendo de el valor de <span class="math inline">\(t\)</span>.</p>
<p>Con el supuesto de falta de memoria, la ecuación de arriba se cumple, y entonces (¿por qué?):</p>
<p><span class="math display">\[P(X &gt; s + t) = P(X &gt; s) P(X &gt; t),\]</span></p>
<p>así que</p>
<p><span class="math display">\[\frac{1}{s}(P(X &gt; s+ t) - P(X&gt;t)) = \frac{1}{s}(P(X&gt;s) - 1)P(X&gt;t).\]</span></p>
<p>Que podemos reescribir usando la densidad <span class="math inline">\(f(x)\)</span> como</p>
<p><span class="math display">\[\frac{1}{s}\int_t^{t+s} f(x)\,dx = P(X&gt;t)\frac{1}{s}\int_0^s f(x)\,dx\]</span></p>
<p>Conforme <span class="math inline">\(s\)</span> se hace más chica, el lado izquierdo converge a <span class="math inline">\(f(t)\)</span>. El lado derecho, por otra parte, converge a <span class="math inline">\(f(0)\)</span>, y obtenemos</p>
<p><span class="math display">\[f(t) = f(0)\int_t^\infty f(x)\,dx,\]</span></p>
<p>y ahora derivamos de ambos lados para obtener</p>
<p><span class="math display">\[f'(t) = -f(0)f(t)\]</span></p>
<p>La única función que satisface esta propiedad (su derivada es proporcional a ella misma) es</p>
<p><span class="math display">\[f(t) = \lambda e^{-\lambda t}\]</span></p>
<p>Puedes checar que efectivamente esta densidad cumple que la ecuación anterior. A esta densidad le llamamos la <strong>densidad exponencial con tasa</strong> <span class="math inline">\(\lambda\)</span>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>sim_exp <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="at">rate =</span> lambda)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> sim_exp), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">boundary =</span> <span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ejercicio: demuestra que una variable aleatoria exponencial con tasa <span class="math inline">\(\lambda\)</span> tiene media <span class="math inline">\(E(X) = 1/\lambda\)</span> y $Var(X) = 1 / ^2</p>
<p>El parámetro <span class="math inline">\(\lambda\)</span> se llama tasa por la interpretación de tiempo de espera que mostramos arriba. Supongamos que <span class="math inline">\(\lambda = 10\)</span>. Eso quiere decir que esperamos observar el evento en <span class="math inline">\(1/\lambda = 1/10\)</span> minutos, por ejemplo, o lo que es lo mismo, a una tasa de <span class="math inline">\(\lambda = 10\)</span> eventos por minuto.</p>
<p>Nótese finalmente que todas las variables exponenciales son escalamientos de una variable exponencial con <span class="math inline">\(\lambda = 1\)</span>. Esto es porque si <span class="math inline">\(Y=kX\)</span>, y <span class="math inline">\(X\)</span> es exponencial con <span class="math inline">\(\lambda= 1\)</span> entonces:</p>
<p><span class="math display">\[P(Y&gt;t)=P(kX &gt; t) = P(X &gt; t/k) = \int_{t/k}^\infty e^{-x}\,dx = e^{-t/k}\]</span></p>
<p>De modo que derivando, encontramos que la densidad de <span class="math inline">\(Y\)</span> es <span class="math inline">\(\frac{1}{k} e^{-t/k}\)</span>, que es una exponencial con tasa <span class="math inline">\(\lambda = 1/k\)</span>.</p>
</section>
<section id="ejemplo-exponencial" class="level3" data-number="10.12.2">
<h3 data-number="10.12.2" class="anchored" data-anchor-id="ejemplo-exponencial"><span class="header-section-number">10.12.2</span> Ejemplo: exponencial</h3>
<p>Supongamos que un tipo de focos tienen tiempos de vida exponencial con una vida media de 10 años. ¿Cuál es la probabilidad de que un foco dure más de 15 años? Si tenemos un foco que ya vivió 10 años, cuál es la probabilidad de que dure otros 15 años.</p>
<p>Tenemos que la vida de un foco es una variable <span class="math inline">\(X\)</span> exponencial con parámetro <span class="math inline">\(\lambda = 1/10\)</span>. La probabilidad de que dure más de 15 años es entonces</p>
<p><span class="math display">\[P(X&gt;15) = \int_{15}^\infty \frac{1}{10} e^{x/10}\,dx\]</span></p>
<p>Podemos calcular a mano, o usar rutinas usuales de R:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="dv">15</span>, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2231302</code></pre>
</div>
</div>
</section>
<section id="variables-aleatorias-gamma" class="level3" data-number="10.12.3">
<h3 data-number="10.12.3" class="anchored" data-anchor-id="variables-aleatorias-gamma"><span class="header-section-number">10.12.3</span> Variables aleatorias gamma</h3>
<p>Esta es otra familia que extiende la familia de distribuciones exponenciales. La forma analítica de una densidad gamma con parámetro de forma <span class="math inline">\(k&gt;0\)</span> y tasa <span class="math inline">\(\lambda\)</span></p>
<p><span class="math display">\[f(x) = C x^{k-1} e^{-\lambda x}\]</span></p>
<p>donde la constante <span class="math inline">\(C\)</span> de normalización depende de <span class="math inline">\(k\)</span> y <span class="math inline">\(\lambda\)</span>.</p>
<p>Abajo vemos datos simulados de densidades Gamma con distintas combinaciones de parámetros:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>params_tbl <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">k =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="at">lambda =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sims_tbl <span class="ot">&lt;-</span> params_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sims =</span> <span class="fu">map2</span>(k, lambda, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">~</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>, <span class="at">shape =</span> .x, <span class="at">rate =</span> .y))) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(<span class="at">cols =</span> sims)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sims_tbl, <span class="fu">aes</span>(<span class="at">x =</span> sims)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(k<span class="sc">~</span>lambda)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nótese que cada columna es un rescalamiento de la otra, pero las densidades de los renglones tienen distinta forma. Puedes ver <a href="https://en.wikipedia.org/wiki/Gamma_distribution">aquí</a> parámetros como esperanza, varianza de esta estas distribuciones, junto con otras propiedades y aplicaciones.</p>
</section>
</section>
<section id="modelos-conjuntos-de-probabilidad" class="level2" data-number="10.13">
<h2 data-number="10.13" class="anchored" data-anchor-id="modelos-conjuntos-de-probabilidad"><span class="header-section-number">10.13</span> Modelos conjuntos de probabilidad</h2>
<p>Usualmente no nos interesa una sola variable aleatoria, sino varias. Nos interesa entender cómo están relacionadas o cómo depende una de otra.</p>
<p>Por ejemplo, ¿cuál es la mediana de peso para un infante de 2 meses, y qué tan diferente es de la mediana de peso para un infante de 5 meses? ¿qué relación hay entre temperatura y presión atmosférica? ¿qué relación hay entre creencias religiosas y afiliación política? En todos estos casos quisiéramos describir de distintas formas cómo ser relaciona una cantidad aleatoria con otra.</p>
<p>Al principio de este curso, vimos algunas técnicas descriptivas para mostrar y explorar estas relaciones. Por ejemplo:</p>
<ul>
<li>¿Cómo cambian las preferencias de forma de tomar té dependiendo del tipo de té una persona acostumbra tomar? ¿Qué tan probable es que alguien que toma té negro use azúcar vs alguien que toma té verde? (relación entre dos variables categóricas o discretas)</li>
<li>¿Cómo cambian los precios medios de las casas dependiendo del vecindario donde se ubican? (describir la dependencia de una variable numérica si sabemos el valor de una variable categórica)</li>
<li>¿Cómo cambia la mediana y los cuartiles de peso de un infante dependiendo de los meses desde que nació (describir cómo depende una variable numérica de otra variable numérica)</li>
</ul>
<p>En esta parte veremos una introducción cómo se formalizan estos conceptos en modelos probabilísticos.</p>
</section>
<section id="estaturas-modelando-relaciones-de-dependencia" class="level2" data-number="10.14">
<h2 data-number="10.14" class="anchored" data-anchor-id="estaturas-modelando-relaciones-de-dependencia"><span class="header-section-number">10.14</span> Estaturas: modelando relaciones de dependencia</h2>
<p>Supongamos que <span class="math inline">\(X\)</span> es la edad de una persona entre 4 y 15 años. y <span class="math inline">\(Y\)</span> es su estatura. La relación entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> no es determinística, pues existe variación en el crecimiento para las personas por distintas razones. Por esta razón, no tiene mucho sentido dar una relación como <span class="math inline">\(Y = 80 + 5.5 X\)</span>, por ejemplo, pues esta relación no se cumple para prácticamente ninguna persona.</p>
<p>Tiene más sentido, sin embargo, decir cómo es <strong>la distribución condicional</strong> de <span class="math inline">\(Y\)</span> dado que conocemos <span class="math inline">\(X\)</span>. Por ejemplo, podríamos hacer la hipótesis de que la mediana de estatura para una persona de edad <span class="math inline">\(X\)</span> está dada por</p>
<p><span class="math display">\[med(Y|X) = 80 + 5.5 X\]</span></p>
<p>Nótese que escribimos la mediana condicional de <span class="math inline">\(Y\)</span> dado que conocemos el valor de <span class="math inline">\(X\)</span>. También podríamos escribir la media condicional de <span class="math inline">\(Y\)</span> dada <span class="math inline">\(X\)</span> como</p>
<p><span class="math display">\[E(Y|X) = 80 + 5.5 X\]</span></p>
<p>Y estas dos cantidades tienen sentido.</p>
<p>Estas cantidades claramente no determinan la variabilidad que hay de la estatura cuando conocemos <span class="math inline">\(X\)</span>. Podríamos entonces también especificar por ejemplo la desviación estándar condicional:</p>
<p><span class="math display">\[\sigma(Y|X) = 3\sqrt{X} \]</span></p>
<p>Generalmente estas relaciones se estiman empíricamente con datos observados, pero para este ejemplo utilizaremos estos modelos fijos.</p>
<p>Simulamos algunos datos con estas propiedades:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">800</span>, <span class="dv">2</span>, <span class="dv">15</span>) <span class="co"># edad distribuida uniforme, o grupos de edad del mismo tamaño</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="ot">&lt;-</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tibble</span>(<span class="at">edad =</span> edades) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">media =</span> <span class="dv">80</span> <span class="sc">+</span> <span class="fl">5.5</span><span class="sc">*</span>edad, <span class="at">desv_est =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(edad)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># para este ejemplo, simulamos con la distribución normal.</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">estatura_cm =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> media, <span class="at">sd =</span> desv_est))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> edad, <span class="at">y =</span> estatura_cm)) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<ul>
<li>Obsérvese cómo en efecto la estatura esperada aumenta con la edad (condicional a la edad), y que la dispersión de estatura aumenta conforme la edad aumenta.</li>
</ul>
<p>Nótese que si usamos un suavizador, podemos estimar la media condicional de nuestro modelo, que en este caso está cercana a la fórmula que establecimos en nuestro modelo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> edad, <span class="at">y =</span> estatura_cm)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Podemos estimar cuantiles también como vimos en secciones anteriores:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> edad, <span class="at">y =</span> estatura_cm)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_quantile</span>(<span class="at">method =</span> <span class="st">"rqss"</span>, <span class="at">lambda =</span> <span class="dv">20</span>, <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.5</span>, <span class="fl">0.90</span>)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ qss(x, lambda = 20)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Y observamos igualmente que la dispersión para el grupo de 15 años es cercana al doble que la dispersión para el grupo de 4 años.</p>
</section>
<section id="distribuciones-condicionales" class="level2" data-number="10.15">
<h2 data-number="10.15" class="anchored" data-anchor-id="distribuciones-condicionales"><span class="header-section-number">10.15</span> Distribuciones condicionales</h2>
<p>Todo el trabajo de arriba de modelación teórica consiste entonces en definir <strong>distribuciones condicionales</strong>. En el ejemplo anterior,</p>
<ul>
<li>Dimos una distribución para <span class="math inline">\(X\)</span>, que en este caso la tomamos uniforme en [4, 15], pues suponemos que esta es la estructura de nuestra población (hay el aproximadamente el mismo número de personas de cada edad)</li>
<li>Dimos una distribución para <span class="math inline">\(Y\)</span> <em>condicionada</em> a <span class="math inline">\(X\)</span>. En este caso, establecimos que <span class="math inline">\(Y|X\)</span> es normal con media <span class="math inline">\(80 + 5.5X\)</span> y desviación estándar <span class="math inline">\(3 * sqrt(X)\)</span>.</li>
</ul>
<p>Estas dos partes dan un <em>modelo conjunto</em> para <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span>: sabemos que está completamente determinado pues pudimos simular del modelo. Otra manera de entender esto es que cualquier probabilidad que involucra a <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> puede ser calculada con la regla del producto. Aunque no entraremos en detalles, la <em>densidad conjunta</em> de <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> puede definirse en este caso como</p>
<p><span class="math display">\[f(x,y) = f_X(x)f_{Y|X}(y|x)\]</span></p>
<p>Sabemos que <span class="math inline">\(f_X(x) = 1/(15- 3)\)</span> para <span class="math inline">\(x\)</span> entre 4 y 15 años, y la forma de <span class="math inline">\(f_{Y|X}(y|x)\)</span> sabemos que es normal con media y varianza conocida (en términos de x). Esta conjunta puede ser integrada sobre cualquier región (al menos en teoría) para calcular la probabilidad de interés</p>
</section>
<section id="estaturas-variación-gamma" class="level2" data-number="10.16">
<h2 data-number="10.16" class="anchored" data-anchor-id="estaturas-variación-gamma"><span class="header-section-number">10.16</span> Estaturas: variación gamma</h2>
<p>Podemos juntar estos bloques de densidades condicionales para construir otro tipo de modelos. Por ejemplo, supondremos que la estatura dada la edad es una distribución gamma <span class="math inline">\((k,\lambda)\)</span> y la misma media y desviación estándar que vimos arriba. Como la media de una gamma de este tipo es <span class="math inline">\(\mu = k/\lambda\)</span> y su desviación estándar es <span class="math inline">\(\sigma = \sqrt{k}/\lambda\)</span>, podemos despejar <span class="math inline">\(k\)</span> y <span class="math inline">\(lambda\)</span> y hacer:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="ot">&lt;-</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tibble</span>(<span class="at">edad =</span> edades) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">media =</span> <span class="dv">80</span> <span class="sc">+</span> <span class="fl">5.5</span><span class="sc">*</span>edad, <span class="at">desv_est =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(edad)) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">k =</span> (media<span class="sc">/</span>desv_est)<span class="sc">^</span><span class="dv">2</span>, <span class="at">lambda =</span> media <span class="sc">/</span> desv_est<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># para este ejemplo, simulamos con la distribución normal.</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">estatura_cm =</span> <span class="fu">rgamma</span>(<span class="fu">n</span>(), <span class="at">shape =</span> k, <span class="at">rate =</span> lambda))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> edad, <span class="at">y =</span> estatura_cm)) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_quantile</span>(<span class="at">method =</span> <span class="st">"rqss"</span>, <span class="at">lambda =</span> <span class="dv">10</span>, </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ qss(x, lambda = 10)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Este modelo es muy similar al normal. Sin embargo, podríamos intentar otras variaciones si cambiamos la magnitud de la desviación estándar en relación a la media, por ejemplo:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="ot">&lt;-</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tibble</span>(<span class="at">edad =</span> edades) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">media =</span> <span class="dv">30</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>edad, <span class="at">desv_est =</span> <span class="dv">7</span> <span class="sc">*</span> (edad)) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">k =</span> (media<span class="sc">/</span>desv_est)<span class="sc">^</span><span class="dv">2</span>, <span class="at">lambda =</span> media <span class="sc">/</span> desv_est<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>   <span class="co"># para este ejemplo, simulamos con la distribución normal.</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">medicion_y =</span> <span class="fu">rgamma</span>(<span class="fu">n</span>(), <span class="at">shape =</span> k, <span class="at">rate =</span> lambda))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> edad, <span class="at">y =</span> medicion_y)) <span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_quantile</span>(<span class="at">method =</span> <span class="st">"rqss"</span>, <span class="at">lambda =</span> <span class="dv">10</span>, </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ qss(x, lambda = 10)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Este caso claramente no serviría para modelar estaturas, pero podemos ver cómo introdujimos asimetría considerable en las distribuciones condicionales de y dado x una vez que especificamos la media y la varianza condicionales.</p>
</section>
<section id="modelos-conjuntos-para-factor-categórico" class="level2" data-number="10.17">
<h2 data-number="10.17" class="anchored" data-anchor-id="modelos-conjuntos-para-factor-categórico"><span class="header-section-number">10.17</span> Modelos conjuntos para factor categórico</h2>
<p>Supongamos ahora que la variable <span class="math inline">\(Y\)</span> es numérica y la variable <span class="math inline">\(X\)</span> es categórica. En este caso, un modelo conjunto está definido por las probabilidades <span class="math inline">\(P(X=x)\)</span> junto con densidades condicionales <span class="math inline">\(Y|X\)</span>.</p>
<section id="ejemplo-cuentas-y-propinas" class="level3" data-number="10.17.1">
<h3 data-number="10.17.1" class="anchored" data-anchor-id="ejemplo-cuentas-y-propinas"><span class="header-section-number">10.17.1</span> Ejemplo: cuentas y propinas</h3>
<p>Supongamos que <span class="math inline">\(X\)</span> es la hora del día (comida y cena) y que <span class="math inline">\(Y\)</span> es el tamaño de la cuenta.</p>
<p>Podríamos establecer por ejemplo, que <span class="math inline">\(Y|X=comida\)</span> es Gamma con media 10 dólares y desviacion estándar 10 dólares. Sin embargo, <span class="math inline">\(Y|X=cena\)</span> es Gamma con media 25 dólares y desviación estándar 20 dólares. Simulamos y analizamos:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="ot">&lt;-</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tibble</span>(<span class="at">hora =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"comida"</span>, <span class="st">"cena"</span>), <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">media =</span> <span class="fu">ifelse</span>(hora <span class="sc">==</span> <span class="st">"comida"</span>, <span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">desv_est =</span> <span class="fu">ifelse</span>(hora <span class="sc">==</span> <span class="st">"comida"</span>, <span class="dv">10</span>, <span class="dv">20</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">cuenta =</span> <span class="fu">rgamma</span>(<span class="fu">n</span>(), <span class="at">shape =</span> (media <span class="sc">/</span> desv_est)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rate =</span> media <span class="sc">/</span> (desv_est<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> hora, <span class="at">y =</span> cuenta)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_boxplot</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y esta gráfica busca mostrar una estimación de las distribuciones condicionales de cuenta dado el turno donde el cliente consumió.</p>
</section>
</section>
<section id="modelos-multivariados" class="level2" data-number="10.18">
<h2 data-number="10.18" class="anchored" data-anchor-id="modelos-multivariados"><span class="header-section-number">10.18</span> Modelos multivariados</h2>
<p>Ahora consideremos que queremos construir un modelo conjunto para tres variables <span class="math inline">\(X, Y\)</span> y <span class="math inline">\(Z\)</span>. La forma en que procedemos dependerá del problema particular, pero podemos usar la regla del producto como guía. Por ejemplo, podríamos dar una distribución para <span class="math inline">\(Z\)</span>, luego una densidad condicional de Y dado <span class="math inline">\(Z\)</span>, y finalmente una condicional de <span class="math inline">\(Y\)</span> dada tanto <span class="math inline">\(X\)</span> como <span class="math inline">\(Z\)</span>.</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Z [pos="0,1"]</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="st">    X [pos="1,0"]</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="st">    Y [pos="2,1"]</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; X -&gt; Y</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>En este caso, cada variable aleatorio es nodo, y representa una distribución condicional dado sus antecesores. Esta gráfica por ejemplo, muestra una manera de escribir con la regla del producto un modelo conjunto, pero podríamos cambiar de posición los nodos dependiendo de nuestro conocimiento y el problema que queremos resolver.</p>
<p>En algunos casos, es posible simplificar la construcción del modelo eliminando algunas aristas. Supongamos por ejemplo que</p>
<ul>
<li>X es la edad de la persona</li>
<li>Z es “M” of “F”</li>
<li>Y es su estatura</li>
</ul>
<p>En este caso, no es necesario especificar la condicional de <span class="math inline">\(X\)</span> dado <span class="math inline">\(Z\)</span>, pues estas dos son variables independientes. Pondríamos entonces simplemente</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Z [pos="0,1"]</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="st">    X [pos="1,0"]</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="st">    Y [pos="2,1"]</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Y</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>Y solo necesitamos especificar las distribuciones de <span class="math inline">\(X\)</span>, de <span class="math inline">\(Z\)</span>, y la condicional de <span class="math inline">\(Y\)</span> dado <span class="math inline">\(Z\)</span>. Siguiendo nuestro ejemplo anterior, consideraremos a</p>
<ul>
<li><span class="math inline">\(X\)</span> como uniforme en <span class="math inline">\([4,15]\)</span> (que es nuestro rango de edad de interés)</li>
<li><span class="math inline">\(Z\)</span> es <span class="math inline">\(M\)</span> con probabilidad 0.5 y <span class="math inline">\(F\)</span> con probabilidad 0.5</li>
</ul>
<p>Y podríamos especificar ahora: la condicional de <span class="math inline">\(Y\)</span> (estatura) es normal con los siguientes parámetros:</p>
<ul>
<li>Si <span class="math inline">\(X\)</span> es la edad y <span class="math inline">\(Z="F"\)</span>, entonces la media es <span class="math inline">\(70 + 6.5 X\)</span></li>
<li>Si <span class="math inline">\(X\)</span> es la edad y <span class="math inline">\(Z="M"\)</span>, entonces la media es <span class="math inline">\(80 + 4.5 X\)</span></li>
<li>La desviación estándar sólo depende de <span class="math inline">\(X\)</span>, y es igual a <span class="math inline">\(4\sqrt{X}\)</span>.</li>
</ul>
<p>Simulamos ahora de este modelo probabilístico:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="dv">4</span>, <span class="dv">15</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>   <span class="co"># independientemente simulamos M o F</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">z =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"m"</span>, <span class="st">"f"</span>), <span class="dv">1000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">media =</span> <span class="fu">ifelse</span>(z<span class="sc">==</span><span class="st">"f"</span>, <span class="dv">70</span> <span class="sc">+</span> <span class="fl">6.5</span> <span class="sc">*</span> x, <span class="dv">80</span> <span class="sc">+</span> <span class="fl">4.5</span> <span class="sc">*</span> x)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">desv_est =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">sqrt</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">estatura =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), media, desv_est))</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>datos_tbl <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:right;"> x </th>
   <th style="text-align:left;"> z </th>
   <th style="text-align:right;"> media </th>
   <th style="text-align:right;"> desv_est </th>
   <th style="text-align:right;"> estatura </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 13.917312 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 142.62790 </td>
   <td style="text-align:right;"> 14.922366 </td>
   <td style="text-align:right;"> 106.17567 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 9.655767 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 123.45095 </td>
   <td style="text-align:right;"> 12.429492 </td>
   <td style="text-align:right;"> 118.95931 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4.178553 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 98.80349 </td>
   <td style="text-align:right;"> 8.176603 </td>
   <td style="text-align:right;"> 102.90009 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4.085706 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 98.38568 </td>
   <td style="text-align:right;"> 8.085252 </td>
   <td style="text-align:right;"> 99.27880 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7.510502 </td>
   <td style="text-align:left;"> f </td>
   <td style="text-align:right;"> 118.81826 </td>
   <td style="text-align:right;"> 10.962118 </td>
   <td style="text-align:right;"> 120.93123 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 9.506507 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 122.77928 </td>
   <td style="text-align:right;"> 12.333049 </td>
   <td style="text-align:right;"> 131.72703 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 8.311886 </td>
   <td style="text-align:left;"> f </td>
   <td style="text-align:right;"> 124.02726 </td>
   <td style="text-align:right;"> 11.532137 </td>
   <td style="text-align:right;"> 127.80079 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10.336809 </td>
   <td style="text-align:left;"> f </td>
   <td style="text-align:right;"> 137.18926 </td>
   <td style="text-align:right;"> 12.860363 </td>
   <td style="text-align:right;"> 138.18963 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 8.578672 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 118.60402 </td>
   <td style="text-align:right;"> 11.715748 </td>
   <td style="text-align:right;"> 133.69638 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 11.500391 </td>
   <td style="text-align:left;"> f </td>
   <td style="text-align:right;"> 144.75254 </td>
   <td style="text-align:right;"> 13.564891 </td>
   <td style="text-align:right;"> 121.21221 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6.668017 </td>
   <td style="text-align:left;"> f </td>
   <td style="text-align:right;"> 113.34211 </td>
   <td style="text-align:right;"> 10.329002 </td>
   <td style="text-align:right;"> 123.89877 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 12.935783 </td>
   <td style="text-align:left;"> f </td>
   <td style="text-align:right;"> 154.08259 </td>
   <td style="text-align:right;"> 14.386540 </td>
   <td style="text-align:right;"> 135.22746 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 14.904618 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 147.07078 </td>
   <td style="text-align:right;"> 15.442600 </td>
   <td style="text-align:right;"> 128.11113 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 11.579196 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 132.10638 </td>
   <td style="text-align:right;"> 13.611287 </td>
   <td style="text-align:right;"> 143.13437 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 14.921303 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 147.14586 </td>
   <td style="text-align:right;"> 15.451241 </td>
   <td style="text-align:right;"> 162.54670 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 8.863920 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 119.88764 </td>
   <td style="text-align:right;"> 11.908934 </td>
   <td style="text-align:right;"> 114.67713 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 8.487825 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 118.19521 </td>
   <td style="text-align:right;"> 11.653549 </td>
   <td style="text-align:right;"> 105.22789 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4.221525 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 98.99686 </td>
   <td style="text-align:right;"> 8.218540 </td>
   <td style="text-align:right;"> 94.52403 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6.803164 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 110.61424 </td>
   <td style="text-align:right;"> 10.433150 </td>
   <td style="text-align:right;"> 108.54392 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 14.458625 </td>
   <td style="text-align:left;"> m </td>
   <td style="text-align:right;"> 145.06381 </td>
   <td style="text-align:right;"> 15.209799 </td>
   <td style="text-align:right;"> 145.96106 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Y hacemos algunas gráficas descriptivas:</p>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> estatura, <span class="at">colour =</span> z)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Discute qué otras cosas podrías cambiar en este modelo probabilístico para que fuera más flexible o más simple. ¿Cómo ajustarías un modelo así a datos reales?</li>
</ul>
<div class="cell">
<details>
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> estatura, <span class="at">colour =</span> z)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(<span class="sc">~</span>z) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_quantile</span>(<span class="at">method =</span> <span class="st">"rqss"</span>, <span class="at">lambda =</span> <span class="dv">10</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ qss(x, lambda = 10)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in rq.fit.sfn(x, y, tau = tau, rhs = rhs, control = control, ...): tiny diagonals replaced with Inf when calling blkfct

Warning in rq.fit.sfn(x, y, tau = tau, rhs = rhs, control = control, ...): tiny diagonals replaced with Inf when calling blkfct

Warning in rq.fit.sfn(x, y, tau = tau, rhs = rhs, control = control, ...): tiny diagonals replaced with Inf when calling blkfct</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Smoothing formula not specified. Using: y ~ qss(x, lambda = 10)</code></pre>
</div>
<div class="cell-output-display">
<p><img src="modelos-continuos_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" type="comentario">

<div class="comentario">
<p>En la modelación probabilística generalmente usamos estos mecanismos (dependencia condicional, independencia) y estos bloques (distribuciones de probabilidad dadas en términos de parámetros) para obtener estimaciones de parámetros de interés.</p>
<p>Las decisiones de cómo usar estos mecanismos y bloques se desprenden de conocimiento de dominio, alcances del análisis, y siempre están sujetos a revisión dependiendo del tipo de desajustes que presenten frente a los datos reales.</p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./prob-condicional.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probabilidad condicional e independencia</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./inferencia-modelos.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Inferencia con modelos probabilísticos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>